<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>squaremap_combine.combine_core API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../squaremap_combine.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;squaremap_combine</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#DEFAULT_TIME_FORMAT">DEFAULT_TIME_FORMAT</a>
            </li>
            <li>
                    <a class="variable" href="#DEFAULT_COORDS_FORMAT">DEFAULT_COORDS_FORMAT</a>
            </li>
            <li>
                    <a class="variable" href="#DETAIL_SBPP">DETAIL_SBPP</a>
            </li>
            <li>
                    <a class="class" href="#Coord2i">Coord2i</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Coord2i.__init__">Coord2i</a>
                        </li>
                        <li>
                                <a class="variable" href="#Coord2i.x">x</a>
                        </li>
                        <li>
                                <a class="variable" href="#Coord2i.y">y</a>
                        </li>
                        <li>
                                <a class="function" href="#Coord2i.as_tuple">as_tuple</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#GameCoord">GameCoord</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GameCoord.to_image_coord">to_image_coord</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MapImageCoord">MapImageCoord</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MapImageCoord.to_game_coord">to_game_coord</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MapImage">MapImage</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MapImage.__init__">MapImage</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.img">img</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.game_zero">game_zero</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.detail_mul">detail_mul</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.mode">mode</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.size">size</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.width">width</a>
                        </li>
                        <li>
                                <a class="variable" href="#MapImage.height">height</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.with_image">with_image</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.getbbox">getbbox</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.paste">paste</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.crop">crop</a>
                        </li>
                        <li>
                                <a class="function" href="#MapImage.resize_canvas">resize_canvas</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#CombinerStyle">CombinerStyle</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#CombinerStyle.__init__">CombinerStyle</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.background_color">background_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.grid_color">grid_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.show_grid_lines">show_grid_lines</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.grid_line_color">grid_line_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.show_grid_text">show_grid_text</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.grid_text_font">grid_text_font</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.grid_text_color">grid_text_color</a>
                        </li>
                        <li>
                                <a class="variable" href="#CombinerStyle.grid_text_size">grid_text_size</a>
                        </li>
                        <li>
                                <a class="function" href="#CombinerStyle.from_json">from_json</a>
                        </li>
                        <li>
                                <a class="function" href="#CombinerStyle.to_json">to_json</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#DEFAULT_COMBINER_STYLE">DEFAULT_COMBINER_STYLE</a>
            </li>
            <li>
                    <a class="class" href="#Combiner">Combiner</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Combiner.__init__">Combiner</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.TILE_SIZE">TILE_SIZE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.STANDARD_WORLDS">STANDARD_WORLDS</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.tiles_dir">tiles_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.use_tqdm">use_tqdm</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.skip_confirmation">skip_confirmation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.grid_interval">grid_interval</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.grid_coords_format">grid_coords_format</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.style">style</a>
                        </li>
                        <li>
                                <a class="variable" href="#Combiner.mapped_worlds">mapped_worlds</a>
                        </li>
                        <li>
                                <a class="function" href="#Combiner.draw_grid_lines">draw_grid_lines</a>
                        </li>
                        <li>
                                <a class="function" href="#Combiner.draw_grid_coords_text">draw_grid_coords_text</a>
                        </li>
                        <li>
                                <a class="function" href="#Combiner.combine">combine</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../squaremap_combine.html">squaremap_combine</a><wbr>.combine_core    </h1>

                        <div class="docstring"><p>Core functionality for squaremap_combine, providing the <code><a href="#Combiner">Combiner</a></code> class amongst others.</p>
</div>

                        <input id="mod-combine_core-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-combine_core-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;Core functionality for squaremap_combine, providing the `Combiner` class amongst others.&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">operator</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Self</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>                    <span class="n">TypeVar</span><span class="p">,</span> <span class="n">cast</span><span class="p">,</span> <span class="n">get_args</span><span class="p">)</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">tqdm.contrib.itertools</span> <span class="kn">import</span> <span class="n">product</span> <span class="k">as</span> <span class="n">tqdm_product</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">squaremap_combine.errors</span> <span class="kn">import</span> <span class="n">AssertionMessage</span><span class="p">,</span> <span class="n">CombineError</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">squaremap_combine.helper</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">StyleJSONEncoder</span><span class="p">,</span> <span class="n">confirm_yn</span><span class="p">,</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>                                      <span class="n">copy_method_signature</span><span class="p">,</span> <span class="n">snap_box</span><span class="p">)</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">squaremap_combine.type_alias</span> <span class="kn">import</span> <span class="n">Rectangle</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span> <span class="c1"># Don&#39;t output anything if this is just being imported</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="n">DEFAULT_TIME_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;?Y-?m-?d_?H-?M-?S&#39;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="n">DEFAULT_COORDS_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{x}</span><span class="s1">, </span><span class="si">{y}</span><span class="s1">)&#39;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="n">DETAIL_SBPP</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">&quot;&quot;&quot;Square-blocks-per-pixel for each detail level.&quot;&quot;&quot;</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="k">class</span> <span class="nc">Coord2i</span><span class="p">:</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a 2D integer coordinate pair.&quot;&quot;&quot;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Coord2i(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">]:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="k">yield</span> <span class="n">i</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="k">def</span> <span class="nf">as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the coordinate as a tuple.&quot;&quot;&quot;</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="k">def</span> <span class="nf">_math</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">math_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Coord2i</span><span class="p">):</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>            <span class="k">return</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">math_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">math_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>            <span class="k">return</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">math_op</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">math_op</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;_math direction must be &quot;l&quot; or &quot;r&quot;; got </span><span class="si">{</span><span class="n">direction</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="k">class</span> <span class="nc">GameCoord</span><span class="p">(</span><span class="n">Coord2i</span><span class="p">):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A coordinate as relative to a Minecraft world.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">    Largely identical to `Coord2i`, but used mainly for typing to more effectively signal what kind of coordinate is expected</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    for a given class or function.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;GameCoord(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this Minecraft coordinate to its position on the given `MapImage`.&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="k">class</span> <span class="nc">MapImageCoord</span><span class="p">(</span><span class="n">Coord2i</span><span class="p">):</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A coordinate as relative to a `MapImage`.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    Largely identical to `Coord2i`, but used mainly for typing to more effectively signal what kind of coordinate is expected</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    for a given class or function.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;MapImageCoord(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">to_game_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this image coordinate to its position on the Minecraft world it represents.&quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">)</span> <span class="o">*</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="k">class</span> <span class="nc">MapImage</span><span class="p">:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A delegator class to extend `Image` with Minecraft-map-specific functionality,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">    like automatically recalculating the world&#39;s 0, 0 position in the image upon any crops or other changes.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">game_zero</span><span class="p">:</span> <span class="s1">&#39;MapImageCoord&#39;</span><span class="p">,</span> <span class="n">detail_mul</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        :param image: The `Image` to convert.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        :param game_zero: At what coordinate on this image 0, 0 would be located in the Minecraft world it represents.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">        :param detail_mul: The detail multiplier for this map.</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">image</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">=</span> <span class="n">game_zero</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span> <span class="o">=</span> <span class="n">detail_mul</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="nd">@property</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">mode</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="nd">@property</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">size</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="nd">@property</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">width</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="nd">@property</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">height</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="nf">with_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a copy of this `MapImage` with only the internal `Image` object changed.&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>    <span class="c1"># Copy signatures for intellisense</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">getbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">paste</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a cropped portion of the original image, along with an accordingly updated `game_zero` property.&quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">resize_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">center_on</span><span class="p">:</span> <span class="n">GameCoord</span><span class="o">=</span><span class="n">GameCoord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns this image centered within a new canvas of the given size,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        centered by a specified coordinate of the original image.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        :param center_on: What coordinate of the Minecraft world to center the image on. Defaults to 0,0.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="n">origin_in_image</span> <span class="o">=</span> <span class="n">center_on</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>        <span class="n">center_distance</span> <span class="o">=</span> <span class="n">origin_in_image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="n">origin_in_image</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="n">paste_area</span><span class="p">:</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="n">new_canvas</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="n">new_canvas</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">,</span> <span class="n">paste_area</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_canvas</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="n">paste_area</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="nd">@dataclass</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="k">class</span> <span class="nc">CombinerStyle</span><span class="p">:</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines styling rules for `Combiner`-generated map images.&quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>    <span class="n">background_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="n">grid_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used as the base for any grid-related colors.&quot;&quot;&quot;</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    <span class="n">show_grid_lines</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw grid lines at the intervals set in the `Combiner` instance. If no interval is set, this is ignored.&quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>    <span class="n">grid_line_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Color</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="n">show_grid_text</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw grid coordinates at the intervals set in the `Combiner` instance. If no interval is set, this is ignored.&quot;&quot;&quot;</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="n">grid_text_font</span><span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Name of a font to use for drawing coordinate text onto the image.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">    Can either be the name of a system-installed font - e.g. &quot;arial&quot; - or a path to a font file - e.g. &quot;documents/my_font.otf&quot;.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>    <span class="n">grid_text_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Color</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>    <span class="n">grid_text_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="c1"># Force type conversion and validation</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">cast</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="c1"># pylint: disable=no-member; false positive, __annotations__ is valid</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;typing.Optional&#39;</span><span class="p">):</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                    <span class="k">continue</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="k">continue</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="n">Color</span><span class="p">:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                    <span class="k">if</span> <span class="n">hexcode</span> <span class="o">:=</span> <span class="n">Color</span><span class="o">.</span><span class="n">ensure_hex_format</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                        <span class="n">val</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">from_hex</span><span class="p">(</span><span class="n">hexcode</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>                        <span class="n">val</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid type given for Color construction: </span><span class="si">{</span><span class="n">val</span><span class="si">!r}</span><span class="s1"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>                <span class="n">val</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_text_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_text_color</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_str_or_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a `CombinerStyle` instance from a JSON file path, or a JSON-formatted string.&quot;&quot;&quot;</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json_str_or_path</span><span class="si">!r}</span><span class="s1"> is not a file or could not be found&#39;</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Dumps this object as a JSON string.&quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">StyleJSONEncoder</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="n">DEFAULT_COMBINER_STYLE</span> <span class="o">=</span> <span class="n">CombinerStyle</span><span class="p">()</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="k">class</span> <span class="nc">Combiner</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes a squaremap `tiles` directory path, handles calculating rows/columns,</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">    and is able to export full map images.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="n">TILE_SIZE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The size of each tile image in pixels.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">    Only made a constant in case squaremap happens to change its image sizes in the future.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>    <span class="n">STANDARD_WORLDS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;overworld&#39;</span><span class="p">,</span> <span class="s1">&#39;the_nether&#39;</span><span class="p">,</span> <span class="s1">&#39;the_end&#39;</span><span class="p">]</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="n">tiles_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">use_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="n">skip_confirmation</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="n">grid_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">grid_coords_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">DEFAULT_COORDS_FORMAT</span><span class="p">,</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="n">style</span><span class="p">:</span> <span class="n">CombinerStyle</span><span class="o">=</span><span class="n">DEFAULT_COMBINER_STYLE</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="p">):</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        :param tiles_dir: A path to a directory in the same format as what squaremap automatically generates.</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">            Example:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        .. code-block:: text</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">            tiles (&lt;- what this path should point to)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">            minecraft_overworld</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">            |   0</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">            |   1</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">            |   2</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">            |   3</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">            minecraft_the_nether</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">            |   0</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            |   1</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">            |   2</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">            |   3</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">            minecraft_the_end</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">                0</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">                1</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">                2</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">                3</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        :param use_tqdm: Whether to show a `tqdm` progress bar for any functions that support it.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        :param skip_confirmation: Whether to skip any confirmation prompts. Setting to `True` allows any function</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">            in this class to run unattended to.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        :param grid_interval: An X and Y interval that should be used for things like drawing grid lines or coordinates onto \</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">            the finished image.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">        :param grid_coords_format: A format string to be used when drawing grid coordinates. \</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">            Valid formatting options are `{x}` and {y}`.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        :param style: `CombinerStyle` instance to define styling rules with.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tiles_dir</span> <span class="o">:=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tiles_dir</span><span class="p">))</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not a directory: </span><span class="si">{</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span>          <span class="o">=</span> <span class="n">tiles_dir</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span>           <span class="o">=</span> <span class="n">use_tqdm</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span>  <span class="o">=</span> <span class="n">skip_confirmation</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span>      <span class="o">=</span> <span class="n">grid_interval</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span> <span class="o">=</span> <span class="n">grid_coords_format</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span>              <span class="o">=</span> <span class="n">style</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tiles_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;minecraft_*/&#39;</span><span class="p">)]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;What valid world folders the given `tiles_dir` contains.&quot;&quot;&quot;</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">draw_grid_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws grid lines onto a `MapImage` at the intervals defined for this `Combiner` instance.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                <span class="p">),</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="p">),</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="p">}</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]:</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>    <span class="k">def</span> <span class="nf">draw_grid_coords_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws coordinate text onto a `MapImage` at every interval as defined for this `Combiner` instance.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="n">bbox_before_grid</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">assert</span> <span class="n">bbox_before_grid</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                <span class="p">),</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                <span class="p">),</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="p">}</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="n">interval_coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MapImageCoord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">MapImageCoord</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]]</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="n">total_intervals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="k">if</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over; this may take some time.&#39;</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over, which can take a very long time.&#39;</span> <span class="o">+</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="s1">&#39; You can press Ctrl+C to cancel during this process if needed. Continue?&#39;</span><span class="p">):</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                <span class="k">return</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">elif</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;More than 5000 grid intervals will be iterated over;&#39;</span> <span class="o">+</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                <span class="s1">&#39; the progress bar</span><span class="se">\&#39;</span><span class="s1">s description text will not update per iteration in order to save speed.&#39;</span><span class="p">)</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing coordinates...&#39;</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">img_coord</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pbar</span> <span class="o">:=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">)):</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="n">game_coord</span> <span class="o">=</span> <span class="n">img_coord</span><span class="o">.</span><span class="n">to_game_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">coord_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span> <span class="ow">and</span> <span class="p">(</span><span class="n">total_intervals</span> <span class="o">&lt;=</span> <span class="mi">5000</span><span class="p">):</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Drawing </span><span class="si">{</span><span class="n">coord_text</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">coord_text</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_text_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="n">world</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>            <span class="n">detail</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>            <span class="n">autotrim</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="n">area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="n">force_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MapImage</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine the given world (dimension) tile images into one large map.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        :param world: Name of the world to combine images of.\</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">            Should be the name of a subdirectory located in this instance&#39;s `tiles_dir`.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        :param detail: The level of detail, 0 up through 3, to use for this map.\</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">            Will correspond to which numbered subdirectory within the given world to use images from.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        :param area: Specifies an area of the world to export rather than rendering the full map.\</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">            Takes coordinates as they would appear in Minecraft. Using this will disable `autotrim` implicitly.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        :param force_size: Centers the final image in a new image of this size.\</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">            Using this will disable `autotrim` implicitly.</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        :returns: Returns the created `MapImage` if successful, or `None` if the process failed or was cancelled at any point.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        :rtype: MapImage, None</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">world</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No world directory of name &quot;</span><span class="si">{</span><span class="n">world</span><span class="si">}</span><span class="s1">&quot; exists in &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">detail</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detail level must be between 0 and 3; given </span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="n">source_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span> <span class="o">/</span> <span class="n">world</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">detail</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="n">detail_mul</span> <span class="o">=</span> <span class="n">DETAIL_SBPP</span><span class="p">[</span><span class="n">detail</span><span class="p">]</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="c1"># Sort out what regions we&#39;re going to stitch</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="n">rows</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finding region images...&#39;</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">source_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*_*.png&#39;</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">):</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="n">col</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>                <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>            <span class="k">if</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>                <span class="n">rows</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="c1"># Deep-sort columns + rows</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="n">regions</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:{</span><span class="n">v</span><span class="p">:</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="n">area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="n">detail_mul</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">area</span><span class="p">])</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>            <span class="n">area_regions</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">snap_box</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)])</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>            <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>            <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="n">size_estimate</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">)</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated image size: </span><span class="si">{</span><span class="n">size_estimate</span><span class="si">}</span><span class="se">\n</span><span class="s1">Continue?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span><span class="p">):</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="c1"># Start stitching</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Constructing image...&#39;</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="n">ta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="c1"># Represents where 0, 0 in our Minecraft world is, in relation to the image&#39;s coordinates</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="n">game_zero_in_image</span><span class="p">:</span> <span class="n">Coord2i</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tqdm_product</span><span class="p">(</span><span class="n">column_range</span><span class="p">,</span> <span class="n">row_range</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Columns&#39;</span><span class="p">):</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">]):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>                <span class="k">continue</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="c1"># The pasting coordinates are determined based on what current column and row the for loops</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="c1"># are on, so they&#39;ll increase by a tile regardless of whether an image has actually been pasted</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">column_range</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="n">tile_path</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>                <span class="n">tqdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pasting image: </span><span class="si">{</span><span class="n">tile_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            <span class="n">paste_area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">])</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_zero_in_image</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>                <span class="n">game_zero_in_image</span> <span class="o">=</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">Coord2i</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">paste</span><span class="p">((</span><span class="n">tile_img</span> <span class="o">:=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tile_path</span><span class="p">)),</span> <span class="n">paste_area</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">tile_img</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="k">assert</span> <span class="n">game_zero_in_image</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">GAME_ZERO_IS_NONE</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="n">game_zero_in_image</span><span class="p">),</span> <span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="k">del</span> <span class="n">game_zero_in_image</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="c1"># Crop if an area is specified</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>            <span class="n">crop_area</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">crop_area</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="c1"># Crop and resize if given an explicit size</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="n">force_size</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">force_size</span><span class="p">):</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Resizing to </span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">force_size</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="c1"># Things like grid lines and coordinate text are likely to end up drawn outside of the image&#39;s original bounding box,</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>        <span class="c1"># alterting what getbbox() would return. Get this bounding box *first*, and then use it to autotrim later.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="k">assert</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">BBOX_IS_NONE</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="c1"># Add grid and/or coordinates</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                <span class="k">raise</span> <span class="n">CombineError</span><span class="p">(</span><span class="s1">&#39;A grid interval must be set for this Combiner instance to add grid lines or grid coordinates&#39;</span><span class="p">)</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_coords_text</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing grid lines...&#39;</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_lines</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="c1"># Trim transparent excess space</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="k">if</span> <span class="n">autotrim</span><span class="p">:</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Trimming out blank space... (</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="c1"># Apply desired background color, if any</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>            <span class="n">image_bg</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>            <span class="n">image_bg</span><span class="o">.</span><span class="n">alpha_composite</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image_bg</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="c1"># Done.</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="n">tb</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Image creation finished in </span><span class="si">{</span><span class="n">tb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ta</span><span class="si">:</span><span class="s1">04f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="k">return</span> <span class="n">image</span>
</span></pre></div>


            </section>
                <section id="DEFAULT_TIME_FORMAT">
                    <div class="attr variable">
            <span class="name">DEFAULT_TIME_FORMAT</span>        =
<span class="default_value">&#39;?Y-?m-?d_?H-?M-?S&#39;</span>

        
    </div>
    <a class="headerlink" href="#DEFAULT_TIME_FORMAT"></a>
    
    

                </section>
                <section id="DEFAULT_COORDS_FORMAT">
                    <div class="attr variable">
            <span class="name">DEFAULT_COORDS_FORMAT</span>        =
<span class="default_value">&#39;({x}, {y})&#39;</span>

        
    </div>
    <a class="headerlink" href="#DEFAULT_COORDS_FORMAT"></a>
    
    

                </section>
                <section id="DETAIL_SBPP">
                    <div class="attr variable">
            <span class="name">DETAIL_SBPP</span><span class="annotation">: dict[int, int]</span>        =
<span class="default_value">{0: 8, 1: 4, 2: 2, 3: 1}</span>

        
    </div>
    <a class="headerlink" href="#DETAIL_SBPP"></a>
    
            <div class="docstring"><p>Square-blocks-per-pixel for each detail level.</p>
</div>


                </section>
                <section id="Coord2i">
                            <input id="Coord2i-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Coord2i</span>:

                <label class="view-source-button" for="Coord2i-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Coord2i"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Coord2i-32"><a href="#Coord2i-32"><span class="linenos">32</span></a><span class="k">class</span> <span class="nc">Coord2i</span><span class="p">:</span>
</span><span id="Coord2i-33"><a href="#Coord2i-33"><span class="linenos">33</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a 2D integer coordinate pair.&quot;&quot;&quot;</span>
</span><span id="Coord2i-34"><a href="#Coord2i-34"><span class="linenos">34</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Coord2i-35"><a href="#Coord2i-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Coord2i-36"><a href="#Coord2i-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="Coord2i-37"><a href="#Coord2i-37"><span class="linenos">37</span></a>
</span><span id="Coord2i-38"><a href="#Coord2i-38"><span class="linenos">38</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Coord2i-39"><a href="#Coord2i-39"><span class="linenos">39</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Coord2i(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="Coord2i-40"><a href="#Coord2i-40"><span class="linenos">40</span></a>
</span><span id="Coord2i-41"><a href="#Coord2i-41"><span class="linenos">41</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Coord2i-42"><a href="#Coord2i-42"><span class="linenos">42</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="Coord2i-43"><a href="#Coord2i-43"><span class="linenos">43</span></a>
</span><span id="Coord2i-44"><a href="#Coord2i-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span><span id="Coord2i-45"><a href="#Coord2i-45"><span class="linenos">45</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">]:</span>
</span><span id="Coord2i-46"><a href="#Coord2i-46"><span class="linenos">46</span></a>            <span class="k">yield</span> <span class="n">i</span>
</span><span id="Coord2i-47"><a href="#Coord2i-47"><span class="linenos">47</span></a>
</span><span id="Coord2i-48"><a href="#Coord2i-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="nf">as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="Coord2i-49"><a href="#Coord2i-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the coordinate as a tuple.&quot;&quot;&quot;</span>
</span><span id="Coord2i-50"><a href="#Coord2i-50"><span class="linenos">50</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Coord2i-51"><a href="#Coord2i-51"><span class="linenos">51</span></a>
</span><span id="Coord2i-52"><a href="#Coord2i-52"><span class="linenos">52</span></a>    <span class="k">def</span> <span class="nf">_math</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">math_op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-53"><a href="#Coord2i-53"><span class="linenos">53</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Coord2i-54"><a href="#Coord2i-54"><span class="linenos">54</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-55"><a href="#Coord2i-55"><span class="linenos">55</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Coord2i</span><span class="p">):</span>
</span><span id="Coord2i-56"><a href="#Coord2i-56"><span class="linenos">56</span></a>            <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Coord2i-57"><a href="#Coord2i-57"><span class="linenos">57</span></a>
</span><span id="Coord2i-58"><a href="#Coord2i-58"><span class="linenos">58</span></a>        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span>
</span><span id="Coord2i-59"><a href="#Coord2i-59"><span class="linenos">59</span></a>            <span class="k">return</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">math_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">math_op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Coord2i-60"><a href="#Coord2i-60"><span class="linenos">60</span></a>        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
</span><span id="Coord2i-61"><a href="#Coord2i-61"><span class="linenos">61</span></a>            <span class="k">return</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">math_op</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">),</span> <span class="n">math_op</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span><span id="Coord2i-62"><a href="#Coord2i-62"><span class="linenos">62</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;_math direction must be &quot;l&quot; or &quot;r&quot;; got </span><span class="si">{</span><span class="n">direction</span><span class="si">!r}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Coord2i-63"><a href="#Coord2i-63"><span class="linenos">63</span></a>
</span><span id="Coord2i-64"><a href="#Coord2i-64"><span class="linenos">64</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-65"><a href="#Coord2i-65"><span class="linenos">65</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-66"><a href="#Coord2i-66"><span class="linenos">66</span></a>    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-67"><a href="#Coord2i-67"><span class="linenos">67</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Coord2i-68"><a href="#Coord2i-68"><span class="linenos">68</span></a>
</span><span id="Coord2i-69"><a href="#Coord2i-69"><span class="linenos">69</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-70"><a href="#Coord2i-70"><span class="linenos">70</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-71"><a href="#Coord2i-71"><span class="linenos">71</span></a>    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-72"><a href="#Coord2i-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">sub</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Coord2i-73"><a href="#Coord2i-73"><span class="linenos">73</span></a>
</span><span id="Coord2i-74"><a href="#Coord2i-74"><span class="linenos">74</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-75"><a href="#Coord2i-75"><span class="linenos">75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-76"><a href="#Coord2i-76"><span class="linenos">76</span></a>    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-77"><a href="#Coord2i-77"><span class="linenos">77</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Coord2i-78"><a href="#Coord2i-78"><span class="linenos">78</span></a>
</span><span id="Coord2i-79"><a href="#Coord2i-79"><span class="linenos">79</span></a>    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-80"><a href="#Coord2i-80"><span class="linenos">80</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-81"><a href="#Coord2i-81"><span class="linenos">81</span></a>    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-82"><a href="#Coord2i-82"><span class="linenos">82</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">floordiv</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Coord2i-83"><a href="#Coord2i-83"><span class="linenos">83</span></a>
</span><span id="Coord2i-84"><a href="#Coord2i-84"><span class="linenos">84</span></a>    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-85"><a href="#Coord2i-85"><span class="linenos">85</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</span><span id="Coord2i-86"><a href="#Coord2i-86"><span class="linenos">86</span></a>    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;int | tuple[int, int] | Coord2i&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Coord2i&#39;</span><span class="p">:</span>
</span><span id="Coord2i-87"><a href="#Coord2i-87"><span class="linenos">87</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">pow</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Represents a 2D integer coordinate pair.</p>
</div>


                            <div id="Coord2i.__init__" class="classattr">
                                        <input id="Coord2i.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Coord2i</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">y</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="Coord2i.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Coord2i.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Coord2i.__init__-34"><a href="#Coord2i.__init__-34"><span class="linenos">34</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Coord2i.__init__-35"><a href="#Coord2i.__init__-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="Coord2i.__init__-36"><a href="#Coord2i.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span></pre></div>


    

                            </div>
                            <div id="Coord2i.x" class="classattr">
                                <div class="attr variable">
            <span class="name">x</span>

        
    </div>
    <a class="headerlink" href="#Coord2i.x"></a>
    
    

                            </div>
                            <div id="Coord2i.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span>

        
    </div>
    <a class="headerlink" href="#Coord2i.y"></a>
    
    

                            </div>
                            <div id="Coord2i.as_tuple" class="classattr">
                                        <input id="Coord2i.as_tuple-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_tuple</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Coord2i.as_tuple-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Coord2i.as_tuple"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Coord2i.as_tuple-48"><a href="#Coord2i.as_tuple-48"><span class="linenos">48</span></a>    <span class="k">def</span> <span class="nf">as_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span><span id="Coord2i.as_tuple-49"><a href="#Coord2i.as_tuple-49"><span class="linenos">49</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the coordinate as a tuple.&quot;&quot;&quot;</span>
</span><span id="Coord2i.as_tuple-50"><a href="#Coord2i.as_tuple-50"><span class="linenos">50</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the coordinate as a tuple.</p>
</div>


                            </div>
                </section>
                <section id="GameCoord">
                            <input id="GameCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GameCoord</span><wbr>(<span class="base"><a href="#Coord2i">Coord2i</a></span>):

                <label class="view-source-button" for="GameCoord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GameCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GameCoord-89"><a href="#GameCoord-89"><span class="linenos">89</span></a><span class="k">class</span> <span class="nc">GameCoord</span><span class="p">(</span><span class="n">Coord2i</span><span class="p">):</span>
</span><span id="GameCoord-90"><a href="#GameCoord-90"><span class="linenos">90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A coordinate as relative to a Minecraft world.</span>
</span><span id="GameCoord-91"><a href="#GameCoord-91"><span class="linenos">91</span></a><span class="sd">    Largely identical to `Coord2i`, but used mainly for typing to more effectively signal what kind of coordinate is expected</span>
</span><span id="GameCoord-92"><a href="#GameCoord-92"><span class="linenos">92</span></a><span class="sd">    for a given class or function.</span>
</span><span id="GameCoord-93"><a href="#GameCoord-93"><span class="linenos">93</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GameCoord-94"><a href="#GameCoord-94"><span class="linenos">94</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GameCoord-95"><a href="#GameCoord-95"><span class="linenos">95</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;GameCoord(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="GameCoord-96"><a href="#GameCoord-96"><span class="linenos">96</span></a>
</span><span id="GameCoord-97"><a href="#GameCoord-97"><span class="linenos">97</span></a>    <span class="k">def</span> <span class="nf">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="GameCoord-98"><a href="#GameCoord-98"><span class="linenos">98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this Minecraft coordinate to its position on the given `MapImage`.&quot;&quot;&quot;</span>
</span><span id="GameCoord-99"><a href="#GameCoord-99"><span class="linenos">99</span></a>        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A coordinate as relative to a Minecraft world.
Largely identical to <code><a href="#Coord2i">Coord2i</a></code>, but used mainly for typing to more effectively signal what kind of coordinate is expected
for a given class or function.</p>
</div>


                            <div id="GameCoord.to_image_coord" class="classattr">
                                        <input id="GameCoord.to_image_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_image_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span><span class="p">:</span> <span class="n"><a href="#MapImage">MapImage</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GameCoord.to_image_coord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GameCoord.to_image_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GameCoord.to_image_coord-97"><a href="#GameCoord.to_image_coord-97"><span class="linenos">97</span></a>    <span class="k">def</span> <span class="nf">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="GameCoord.to_image_coord-98"><a href="#GameCoord.to_image_coord-98"><span class="linenos">98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this Minecraft coordinate to its position on the given `MapImage`.&quot;&quot;&quot;</span>
</span><span id="GameCoord.to_image_coord-99"><a href="#GameCoord.to_image_coord-99"><span class="linenos">99</span></a>        <span class="k">return</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts this Minecraft coordinate to its position on the given <code><a href="#MapImage">MapImage</a></code>.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Coord2i">Coord2i</a></dt>
                                <dd id="GameCoord.__init__" class="function"><a href="#Coord2i.__init__">Coord2i</a></dd>
                <dd id="GameCoord.x" class="variable"><a href="#Coord2i.x">x</a></dd>
                <dd id="GameCoord.y" class="variable"><a href="#Coord2i.y">y</a></dd>
                <dd id="GameCoord.as_tuple" class="function"><a href="#Coord2i.as_tuple">as_tuple</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MapImageCoord">
                            <input id="MapImageCoord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MapImageCoord</span><wbr>(<span class="base"><a href="#Coord2i">Coord2i</a></span>):

                <label class="view-source-button" for="MapImageCoord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImageCoord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImageCoord-101"><a href="#MapImageCoord-101"><span class="linenos">101</span></a><span class="k">class</span> <span class="nc">MapImageCoord</span><span class="p">(</span><span class="n">Coord2i</span><span class="p">):</span>
</span><span id="MapImageCoord-102"><a href="#MapImageCoord-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A coordinate as relative to a `MapImage`.</span>
</span><span id="MapImageCoord-103"><a href="#MapImageCoord-103"><span class="linenos">103</span></a><span class="sd">    Largely identical to `Coord2i`, but used mainly for typing to more effectively signal what kind of coordinate is expected</span>
</span><span id="MapImageCoord-104"><a href="#MapImageCoord-104"><span class="linenos">104</span></a><span class="sd">    for a given class or function.</span>
</span><span id="MapImageCoord-105"><a href="#MapImageCoord-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MapImageCoord-106"><a href="#MapImageCoord-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MapImageCoord-107"><a href="#MapImageCoord-107"><span class="linenos">107</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;MapImageCoord(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)&#39;</span>
</span><span id="MapImageCoord-108"><a href="#MapImageCoord-108"><span class="linenos">108</span></a>
</span><span id="MapImageCoord-109"><a href="#MapImageCoord-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">to_game_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="MapImageCoord-110"><a href="#MapImageCoord-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this image coordinate to its position on the Minecraft world it represents.&quot;&quot;&quot;</span>
</span><span id="MapImageCoord-111"><a href="#MapImageCoord-111"><span class="linenos">111</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">)</span> <span class="o">*</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span>
</span></pre></div>


            <div class="docstring"><p>A coordinate as relative to a <code><a href="#MapImage">MapImage</a></code>.
Largely identical to <code><a href="#Coord2i">Coord2i</a></code>, but used mainly for typing to more effectively signal what kind of coordinate is expected
for a given class or function.</p>
</div>


                            <div id="MapImageCoord.to_game_coord" class="classattr">
                                        <input id="MapImageCoord.to_game_coord-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_game_coord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span><span class="p">:</span> <span class="n"><a href="#MapImage">MapImage</a></span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MapImageCoord.to_game_coord-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImageCoord.to_game_coord"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImageCoord.to_game_coord-109"><a href="#MapImageCoord.to_game_coord-109"><span class="linenos">109</span></a>    <span class="k">def</span> <span class="nf">to_game_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">):</span>
</span><span id="MapImageCoord.to_game_coord-110"><a href="#MapImageCoord.to_game_coord-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts this image coordinate to its position on the Minecraft world it represents.&quot;&quot;&quot;</span>
</span><span id="MapImageCoord.to_game_coord-111"><a href="#MapImageCoord.to_game_coord-111"><span class="linenos">111</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span> <span class="o">-</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">)</span> <span class="o">*</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span>
</span></pre></div>


            <div class="docstring"><p>Converts this image coordinate to its position on the Minecraft world it represents.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Coord2i">Coord2i</a></dt>
                                <dd id="MapImageCoord.__init__" class="function"><a href="#Coord2i.__init__">Coord2i</a></dd>
                <dd id="MapImageCoord.x" class="variable"><a href="#Coord2i.x">x</a></dd>
                <dd id="MapImageCoord.y" class="variable"><a href="#Coord2i.y">y</a></dd>
                <dd id="MapImageCoord.as_tuple" class="function"><a href="#Coord2i.as_tuple">as_tuple</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MapImage">
                            <input id="MapImage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MapImage</span>:

                <label class="view-source-button" for="MapImage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage-113"><a href="#MapImage-113"><span class="linenos">113</span></a><span class="k">class</span> <span class="nc">MapImage</span><span class="p">:</span>
</span><span id="MapImage-114"><a href="#MapImage-114"><span class="linenos">114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A delegator class to extend `Image` with Minecraft-map-specific functionality,</span>
</span><span id="MapImage-115"><a href="#MapImage-115"><span class="linenos">115</span></a><span class="sd">    like automatically recalculating the world&#39;s 0, 0 position in the image upon any crops or other changes.</span>
</span><span id="MapImage-116"><a href="#MapImage-116"><span class="linenos">116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MapImage-117"><a href="#MapImage-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">game_zero</span><span class="p">:</span> <span class="s1">&#39;MapImageCoord&#39;</span><span class="p">,</span> <span class="n">detail_mul</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="MapImage-118"><a href="#MapImage-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MapImage-119"><a href="#MapImage-119"><span class="linenos">119</span></a><span class="sd">        :param image: The `Image` to convert.</span>
</span><span id="MapImage-120"><a href="#MapImage-120"><span class="linenos">120</span></a><span class="sd">        :param game_zero: At what coordinate on this image 0, 0 would be located in the Minecraft world it represents.</span>
</span><span id="MapImage-121"><a href="#MapImage-121"><span class="linenos">121</span></a><span class="sd">        :param detail_mul: The detail multiplier for this map.</span>
</span><span id="MapImage-122"><a href="#MapImage-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage-123"><a href="#MapImage-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">image</span>
</span><span id="MapImage-124"><a href="#MapImage-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">=</span> <span class="n">game_zero</span>
</span><span id="MapImage-125"><a href="#MapImage-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span> <span class="o">=</span> <span class="n">detail_mul</span>
</span><span id="MapImage-126"><a href="#MapImage-126"><span class="linenos">126</span></a>
</span><span id="MapImage-127"><a href="#MapImage-127"><span class="linenos">127</span></a>    <span class="nd">@property</span>
</span><span id="MapImage-128"><a href="#MapImage-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-129"><a href="#MapImage-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">mode</span>
</span><span id="MapImage-130"><a href="#MapImage-130"><span class="linenos">130</span></a>    <span class="nd">@property</span>
</span><span id="MapImage-131"><a href="#MapImage-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-132"><a href="#MapImage-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">size</span>
</span><span id="MapImage-133"><a href="#MapImage-133"><span class="linenos">133</span></a>    <span class="nd">@property</span>
</span><span id="MapImage-134"><a href="#MapImage-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-135"><a href="#MapImage-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">width</span>
</span><span id="MapImage-136"><a href="#MapImage-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="MapImage-137"><a href="#MapImage-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-138"><a href="#MapImage-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">height</span>
</span><span id="MapImage-139"><a href="#MapImage-139"><span class="linenos">139</span></a>
</span><span id="MapImage-140"><a href="#MapImage-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">with_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage-141"><a href="#MapImage-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a copy of this `MapImage` with only the internal `Image` object changed.&quot;&quot;&quot;</span>
</span><span id="MapImage-142"><a href="#MapImage-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="MapImage-143"><a href="#MapImage-143"><span class="linenos">143</span></a>
</span><span id="MapImage-144"><a href="#MapImage-144"><span class="linenos">144</span></a>    <span class="c1"># Copy signatures for intellisense</span>
</span><span id="MapImage-145"><a href="#MapImage-145"><span class="linenos">145</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">)</span>
</span><span id="MapImage-146"><a href="#MapImage-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">getbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-147"><a href="#MapImage-147"><span class="linenos">147</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="MapImage-148"><a href="#MapImage-148"><span class="linenos">148</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">paste</span><span class="p">)</span>
</span><span id="MapImage-149"><a href="#MapImage-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">paste</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-150"><a href="#MapImage-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MapImage-151"><a href="#MapImage-151"><span class="linenos">151</span></a>    <span class="nd">@copy_method_signature</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">save</span><span class="p">)</span>
</span><span id="MapImage-152"><a href="#MapImage-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage-153"><a href="#MapImage-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MapImage-154"><a href="#MapImage-154"><span class="linenos">154</span></a>
</span><span id="MapImage-155"><a href="#MapImage-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage-156"><a href="#MapImage-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a cropped portion of the original image, along with an accordingly updated `game_zero` property.&quot;&quot;&quot;</span>
</span><span id="MapImage-157"><a href="#MapImage-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="MapImage-158"><a href="#MapImage-158"><span class="linenos">158</span></a>
</span><span id="MapImage-159"><a href="#MapImage-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">resize_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">center_on</span><span class="p">:</span> <span class="n">GameCoord</span><span class="o">=</span><span class="n">GameCoord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage-160"><a href="#MapImage-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns this image centered within a new canvas of the given size,</span>
</span><span id="MapImage-161"><a href="#MapImage-161"><span class="linenos">161</span></a><span class="sd">        centered by a specified coordinate of the original image.</span>
</span><span id="MapImage-162"><a href="#MapImage-162"><span class="linenos">162</span></a>
</span><span id="MapImage-163"><a href="#MapImage-163"><span class="linenos">163</span></a><span class="sd">        :param center_on: What coordinate of the Minecraft world to center the image on. Defaults to 0,0.</span>
</span><span id="MapImage-164"><a href="#MapImage-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage-165"><a href="#MapImage-165"><span class="linenos">165</span></a>        <span class="n">origin_in_image</span> <span class="o">=</span> <span class="n">center_on</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MapImage-166"><a href="#MapImage-166"><span class="linenos">166</span></a>        <span class="n">center_distance</span> <span class="o">=</span> <span class="n">origin_in_image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="n">origin_in_image</span>
</span><span id="MapImage-167"><a href="#MapImage-167"><span class="linenos">167</span></a>        <span class="n">paste_area</span><span class="p">:</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MapImage-168"><a href="#MapImage-168"><span class="linenos">168</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="MapImage-169"><a href="#MapImage-169"><span class="linenos">169</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="MapImage-170"><a href="#MapImage-170"><span class="linenos">170</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="MapImage-171"><a href="#MapImage-171"><span class="linenos">171</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="MapImage-172"><a href="#MapImage-172"><span class="linenos">172</span></a>        <span class="p">)</span>
</span><span id="MapImage-173"><a href="#MapImage-173"><span class="linenos">173</span></a>        <span class="n">new_canvas</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="MapImage-174"><a href="#MapImage-174"><span class="linenos">174</span></a>        <span class="n">new_canvas</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">,</span> <span class="n">paste_area</span><span class="p">)</span>
</span><span id="MapImage-175"><a href="#MapImage-175"><span class="linenos">175</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_canvas</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="n">paste_area</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A delegator class to extend <code>Image</code> with Minecraft-map-specific functionality,
like automatically recalculating the world's 0, 0 position in the image upon any crops or other changes.</p>
</div>


                            <div id="MapImage.__init__" class="classattr">
                                        <input id="MapImage.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MapImage</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">image</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span>,</span><span class="param">	<span class="n">game_zero</span><span class="p">:</span> <span class="n"><a href="#MapImageCoord">MapImageCoord</a></span>,</span><span class="param">	<span class="n">detail_mul</span><span class="p">:</span> <span class="nb">int</span></span>)</span>

                <label class="view-source-button" for="MapImage.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.__init__-117"><a href="#MapImage.__init__-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="n">game_zero</span><span class="p">:</span> <span class="s1">&#39;MapImageCoord&#39;</span><span class="p">,</span> <span class="n">detail_mul</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="MapImage.__init__-118"><a href="#MapImage.__init__-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MapImage.__init__-119"><a href="#MapImage.__init__-119"><span class="linenos">119</span></a><span class="sd">        :param image: The `Image` to convert.</span>
</span><span id="MapImage.__init__-120"><a href="#MapImage.__init__-120"><span class="linenos">120</span></a><span class="sd">        :param game_zero: At what coordinate on this image 0, 0 would be located in the Minecraft world it represents.</span>
</span><span id="MapImage.__init__-121"><a href="#MapImage.__init__-121"><span class="linenos">121</span></a><span class="sd">        :param detail_mul: The detail multiplier for this map.</span>
</span><span id="MapImage.__init__-122"><a href="#MapImage.__init__-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage.__init__-123"><a href="#MapImage.__init__-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">image</span>
</span><span id="MapImage.__init__-124"><a href="#MapImage.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">=</span> <span class="n">game_zero</span>
</span><span id="MapImage.__init__-125"><a href="#MapImage.__init__-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span> <span class="o">=</span> <span class="n">detail_mul</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>image</strong>:  The <code>Image</code> to convert.</li>
<li><strong>game_zero</strong>:  At what coordinate on this image 0, 0 would be located in the Minecraft world it represents.</li>
<li><strong>detail_mul</strong>:  The detail multiplier for this map.</li>
</ul>
</div>


                            </div>
                            <div id="MapImage.img" class="classattr">
                                <div class="attr variable">
            <span class="name">img</span>

        
    </div>
    <a class="headerlink" href="#MapImage.img"></a>
    
    

                            </div>
                            <div id="MapImage.game_zero" class="classattr">
                                <div class="attr variable">
            <span class="name">game_zero</span>

        
    </div>
    <a class="headerlink" href="#MapImage.game_zero"></a>
    
    

                            </div>
                            <div id="MapImage.detail_mul" class="classattr">
                                <div class="attr variable">
            <span class="name">detail_mul</span>

        
    </div>
    <a class="headerlink" href="#MapImage.detail_mul"></a>
    
    

                            </div>
                            <div id="MapImage.mode" class="classattr">
                                        <input id="MapImage.mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">mode</span>

                <label class="view-source-button" for="MapImage.mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.mode-127"><a href="#MapImage.mode-127"><span class="linenos">127</span></a>    <span class="nd">@property</span>
</span><span id="MapImage.mode-128"><a href="#MapImage.mode-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage.mode-129"><a href="#MapImage.mode-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">mode</span>
</span></pre></div>


    

                            </div>
                            <div id="MapImage.size" class="classattr">
                                        <input id="MapImage.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">size</span>

                <label class="view-source-button" for="MapImage.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.size-130"><a href="#MapImage.size-130"><span class="linenos">130</span></a>    <span class="nd">@property</span>
</span><span id="MapImage.size-131"><a href="#MapImage.size-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage.size-132"><a href="#MapImage.size-132"><span class="linenos">132</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">size</span>
</span></pre></div>


    

                            </div>
                            <div id="MapImage.width" class="classattr">
                                        <input id="MapImage.width-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">width</span>

                <label class="view-source-button" for="MapImage.width-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.width"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.width-133"><a href="#MapImage.width-133"><span class="linenos">133</span></a>    <span class="nd">@property</span>
</span><span id="MapImage.width-134"><a href="#MapImage.width-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage.width-135"><a href="#MapImage.width-135"><span class="linenos">135</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">width</span>
</span></pre></div>


    

                            </div>
                            <div id="MapImage.height" class="classattr">
                                        <input id="MapImage.height-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">height</span>

                <label class="view-source-button" for="MapImage.height-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.height"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.height-136"><a href="#MapImage.height-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="MapImage.height-137"><a href="#MapImage.height-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pylint: disable=missing-function-docstring</span>
</span><span id="MapImage.height-138"><a href="#MapImage.height-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">height</span>
</span></pre></div>


    

                            </div>
                            <div id="MapImage.with_image" class="classattr">
                                        <input id="MapImage.with_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">with_image</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">new_image</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span></span><span class="return-annotation">) -> <span class="n"><a href="#MapImage">MapImage</a></span>:</span></span>

                <label class="view-source-button" for="MapImage.with_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.with_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.with_image-140"><a href="#MapImage.with_image-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">with_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_image</span><span class="p">:</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage.with_image-141"><a href="#MapImage.with_image-141"><span class="linenos">141</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a copy of this `MapImage` with only the internal `Image` object changed.&quot;&quot;&quot;</span>
</span><span id="MapImage.with_image-142"><a href="#MapImage.with_image-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a copy of this <code><a href="#MapImage">MapImage</a></code> with only the internal <code>Image</code> object changed.</p>
</div>


                            </div>
                            <div id="MapImage.getbbox" class="classattr">
                                        <input id="MapImage.getbbox-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">getbbox</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span>, </span><span class="param"><span class="n">alpha_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="MapImage.getbbox-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.getbbox"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.getbbox-1398"><a href="#MapImage.getbbox-1398"><span class="linenos">1398</span></a>    <span class="k">def</span> <span class="nf">getbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">alpha_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MapImage.getbbox-1399"><a href="#MapImage.getbbox-1399"><span class="linenos">1399</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MapImage.getbbox-1400"><a href="#MapImage.getbbox-1400"><span class="linenos">1400</span></a><span class="sd">        Calculates the bounding box of the non-zero regions in the</span>
</span><span id="MapImage.getbbox-1401"><a href="#MapImage.getbbox-1401"><span class="linenos">1401</span></a><span class="sd">        image.</span>
</span><span id="MapImage.getbbox-1402"><a href="#MapImage.getbbox-1402"><span class="linenos">1402</span></a>
</span><span id="MapImage.getbbox-1403"><a href="#MapImage.getbbox-1403"><span class="linenos">1403</span></a><span class="sd">        :param alpha_only: Optional flag, defaulting to ``True``.</span>
</span><span id="MapImage.getbbox-1404"><a href="#MapImage.getbbox-1404"><span class="linenos">1404</span></a><span class="sd">           If ``True`` and the image has an alpha channel, trim transparent pixels.</span>
</span><span id="MapImage.getbbox-1405"><a href="#MapImage.getbbox-1405"><span class="linenos">1405</span></a><span class="sd">           Otherwise, trim pixels when all channels are zero.</span>
</span><span id="MapImage.getbbox-1406"><a href="#MapImage.getbbox-1406"><span class="linenos">1406</span></a><span class="sd">           Keyword-only argument.</span>
</span><span id="MapImage.getbbox-1407"><a href="#MapImage.getbbox-1407"><span class="linenos">1407</span></a><span class="sd">        :returns: The bounding box is returned as a 4-tuple defining the</span>
</span><span id="MapImage.getbbox-1408"><a href="#MapImage.getbbox-1408"><span class="linenos">1408</span></a><span class="sd">           left, upper, right, and lower pixel coordinate. See</span>
</span><span id="MapImage.getbbox-1409"><a href="#MapImage.getbbox-1409"><span class="linenos">1409</span></a><span class="sd">           :ref:`coordinate-system`. If the image is completely empty, this</span>
</span><span id="MapImage.getbbox-1410"><a href="#MapImage.getbbox-1410"><span class="linenos">1410</span></a><span class="sd">           method returns None.</span>
</span><span id="MapImage.getbbox-1411"><a href="#MapImage.getbbox-1411"><span class="linenos">1411</span></a>
</span><span id="MapImage.getbbox-1412"><a href="#MapImage.getbbox-1412"><span class="linenos">1412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage.getbbox-1413"><a href="#MapImage.getbbox-1413"><span class="linenos">1413</span></a>
</span><span id="MapImage.getbbox-1414"><a href="#MapImage.getbbox-1414"><span class="linenos">1414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="MapImage.getbbox-1415"><a href="#MapImage.getbbox-1415"><span class="linenos">1415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">getbbox</span><span class="p">(</span><span class="n">alpha_only</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the bounding box of the non-zero regions in the
image.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>alpha_only</strong>:  Optional flag, defaulting to <code>True</code>.
If <code>True</code> and the image has an alpha channel, trim transparent pixels.
Otherwise, trim pixels when all channels are zero.
Keyword-only argument.
:returns: The bounding box is returned as a 4-tuple defining the
left, upper, right, and lower pixel coordinate. See
:ref:<code>coordinate-system</code>. If the image is completely empty, this
method returns None.</li>
</ul>
</div>


                            </div>
                            <div id="MapImage.paste" class="classattr">
                                        <input id="MapImage.paste-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">paste</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">im</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>,</span><span class="param">	<span class="n">box</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mask</span><span class="p">:</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="MapImage.paste-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.paste"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.paste-1762"><a href="#MapImage.paste-1762"><span class="linenos">1762</span></a>    <span class="k">def</span> <span class="nf">paste</span><span class="p">(</span>
</span><span id="MapImage.paste-1763"><a href="#MapImage.paste-1763"><span class="linenos">1763</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MapImage.paste-1764"><a href="#MapImage.paste-1764"><span class="linenos">1764</span></a>        <span class="n">im</span><span class="p">:</span> <span class="n">Image</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
</span><span id="MapImage.paste-1765"><a href="#MapImage.paste-1765"><span class="linenos">1765</span></a>        <span class="n">box</span><span class="p">:</span> <span class="n">Image</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MapImage.paste-1766"><a href="#MapImage.paste-1766"><span class="linenos">1766</span></a>        <span class="n">mask</span><span class="p">:</span> <span class="n">Image</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MapImage.paste-1767"><a href="#MapImage.paste-1767"><span class="linenos">1767</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MapImage.paste-1768"><a href="#MapImage.paste-1768"><span class="linenos">1768</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MapImage.paste-1769"><a href="#MapImage.paste-1769"><span class="linenos">1769</span></a><span class="sd">        Pastes another image into this image. The box argument is either</span>
</span><span id="MapImage.paste-1770"><a href="#MapImage.paste-1770"><span class="linenos">1770</span></a><span class="sd">        a 2-tuple giving the upper left corner, a 4-tuple defining the</span>
</span><span id="MapImage.paste-1771"><a href="#MapImage.paste-1771"><span class="linenos">1771</span></a><span class="sd">        left, upper, right, and lower pixel coordinate, or None (same as</span>
</span><span id="MapImage.paste-1772"><a href="#MapImage.paste-1772"><span class="linenos">1772</span></a><span class="sd">        (0, 0)). See :ref:`coordinate-system`. If a 4-tuple is given, the size</span>
</span><span id="MapImage.paste-1773"><a href="#MapImage.paste-1773"><span class="linenos">1773</span></a><span class="sd">        of the pasted image must match the size of the region.</span>
</span><span id="MapImage.paste-1774"><a href="#MapImage.paste-1774"><span class="linenos">1774</span></a>
</span><span id="MapImage.paste-1775"><a href="#MapImage.paste-1775"><span class="linenos">1775</span></a><span class="sd">        If the modes don&#39;t match, the pasted image is converted to the mode of</span>
</span><span id="MapImage.paste-1776"><a href="#MapImage.paste-1776"><span class="linenos">1776</span></a><span class="sd">        this image (see the :py:meth:`~PIL.Image.Image.convert` method for</span>
</span><span id="MapImage.paste-1777"><a href="#MapImage.paste-1777"><span class="linenos">1777</span></a><span class="sd">        details).</span>
</span><span id="MapImage.paste-1778"><a href="#MapImage.paste-1778"><span class="linenos">1778</span></a>
</span><span id="MapImage.paste-1779"><a href="#MapImage.paste-1779"><span class="linenos">1779</span></a><span class="sd">        Instead of an image, the source can be a integer or tuple</span>
</span><span id="MapImage.paste-1780"><a href="#MapImage.paste-1780"><span class="linenos">1780</span></a><span class="sd">        containing pixel values.  The method then fills the region</span>
</span><span id="MapImage.paste-1781"><a href="#MapImage.paste-1781"><span class="linenos">1781</span></a><span class="sd">        with the given color.  When creating RGB images, you can</span>
</span><span id="MapImage.paste-1782"><a href="#MapImage.paste-1782"><span class="linenos">1782</span></a><span class="sd">        also use color strings as supported by the ImageColor module.</span>
</span><span id="MapImage.paste-1783"><a href="#MapImage.paste-1783"><span class="linenos">1783</span></a>
</span><span id="MapImage.paste-1784"><a href="#MapImage.paste-1784"><span class="linenos">1784</span></a><span class="sd">        If a mask is given, this method updates only the regions</span>
</span><span id="MapImage.paste-1785"><a href="#MapImage.paste-1785"><span class="linenos">1785</span></a><span class="sd">        indicated by the mask. You can use either &quot;1&quot;, &quot;L&quot;, &quot;LA&quot;, &quot;RGBA&quot;</span>
</span><span id="MapImage.paste-1786"><a href="#MapImage.paste-1786"><span class="linenos">1786</span></a><span class="sd">        or &quot;RGBa&quot; images (if present, the alpha band is used as mask).</span>
</span><span id="MapImage.paste-1787"><a href="#MapImage.paste-1787"><span class="linenos">1787</span></a><span class="sd">        Where the mask is 255, the given image is copied as is.  Where</span>
</span><span id="MapImage.paste-1788"><a href="#MapImage.paste-1788"><span class="linenos">1788</span></a><span class="sd">        the mask is 0, the current value is preserved.  Intermediate</span>
</span><span id="MapImage.paste-1789"><a href="#MapImage.paste-1789"><span class="linenos">1789</span></a><span class="sd">        values will mix the two images together, including their alpha</span>
</span><span id="MapImage.paste-1790"><a href="#MapImage.paste-1790"><span class="linenos">1790</span></a><span class="sd">        channels if they have them.</span>
</span><span id="MapImage.paste-1791"><a href="#MapImage.paste-1791"><span class="linenos">1791</span></a>
</span><span id="MapImage.paste-1792"><a href="#MapImage.paste-1792"><span class="linenos">1792</span></a><span class="sd">        See :py:meth:`~PIL.Image.Image.alpha_composite` if you want to</span>
</span><span id="MapImage.paste-1793"><a href="#MapImage.paste-1793"><span class="linenos">1793</span></a><span class="sd">        combine images with respect to their alpha channels.</span>
</span><span id="MapImage.paste-1794"><a href="#MapImage.paste-1794"><span class="linenos">1794</span></a>
</span><span id="MapImage.paste-1795"><a href="#MapImage.paste-1795"><span class="linenos">1795</span></a><span class="sd">        :param im: Source image or pixel value (integer, float or tuple).</span>
</span><span id="MapImage.paste-1796"><a href="#MapImage.paste-1796"><span class="linenos">1796</span></a><span class="sd">        :param box: An optional 4-tuple giving the region to paste into.</span>
</span><span id="MapImage.paste-1797"><a href="#MapImage.paste-1797"><span class="linenos">1797</span></a><span class="sd">           If a 2-tuple is used instead, it&#39;s treated as the upper left</span>
</span><span id="MapImage.paste-1798"><a href="#MapImage.paste-1798"><span class="linenos">1798</span></a><span class="sd">           corner.  If omitted or None, the source is pasted into the</span>
</span><span id="MapImage.paste-1799"><a href="#MapImage.paste-1799"><span class="linenos">1799</span></a><span class="sd">           upper left corner.</span>
</span><span id="MapImage.paste-1800"><a href="#MapImage.paste-1800"><span class="linenos">1800</span></a>
</span><span id="MapImage.paste-1801"><a href="#MapImage.paste-1801"><span class="linenos">1801</span></a><span class="sd">           If an image is given as the second argument and there is no</span>
</span><span id="MapImage.paste-1802"><a href="#MapImage.paste-1802"><span class="linenos">1802</span></a><span class="sd">           third, the box defaults to (0, 0), and the second argument</span>
</span><span id="MapImage.paste-1803"><a href="#MapImage.paste-1803"><span class="linenos">1803</span></a><span class="sd">           is interpreted as a mask image.</span>
</span><span id="MapImage.paste-1804"><a href="#MapImage.paste-1804"><span class="linenos">1804</span></a><span class="sd">        :param mask: An optional mask image.</span>
</span><span id="MapImage.paste-1805"><a href="#MapImage.paste-1805"><span class="linenos">1805</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage.paste-1806"><a href="#MapImage.paste-1806"><span class="linenos">1806</span></a>
</span><span id="MapImage.paste-1807"><a href="#MapImage.paste-1807"><span class="linenos">1807</span></a>        <span class="k">if</span> <span class="n">isImageType</span><span class="p">(</span><span class="n">box</span><span class="p">):</span>
</span><span id="MapImage.paste-1808"><a href="#MapImage.paste-1808"><span class="linenos">1808</span></a>            <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MapImage.paste-1809"><a href="#MapImage.paste-1809"><span class="linenos">1809</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;If using second argument as mask, third argument must be None&quot;</span>
</span><span id="MapImage.paste-1810"><a href="#MapImage.paste-1810"><span class="linenos">1810</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="MapImage.paste-1811"><a href="#MapImage.paste-1811"><span class="linenos">1811</span></a>            <span class="c1"># abbreviated paste(im, mask) syntax</span>
</span><span id="MapImage.paste-1812"><a href="#MapImage.paste-1812"><span class="linenos">1812</span></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">box</span>
</span><span id="MapImage.paste-1813"><a href="#MapImage.paste-1813"><span class="linenos">1813</span></a>            <span class="n">box</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MapImage.paste-1814"><a href="#MapImage.paste-1814"><span class="linenos">1814</span></a>        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">Image</span><span class="p">)</span>
</span><span id="MapImage.paste-1815"><a href="#MapImage.paste-1815"><span class="linenos">1815</span></a>
</span><span id="MapImage.paste-1816"><a href="#MapImage.paste-1816"><span class="linenos">1816</span></a>        <span class="k">if</span> <span class="n">box</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MapImage.paste-1817"><a href="#MapImage.paste-1817"><span class="linenos">1817</span></a>            <span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MapImage.paste-1818"><a href="#MapImage.paste-1818"><span class="linenos">1818</span></a>
</span><span id="MapImage.paste-1819"><a href="#MapImage.paste-1819"><span class="linenos">1819</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">box</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="MapImage.paste-1820"><a href="#MapImage.paste-1820"><span class="linenos">1820</span></a>            <span class="c1"># upper left corner given; get size from image or mask</span>
</span><span id="MapImage.paste-1821"><a href="#MapImage.paste-1821"><span class="linenos">1821</span></a>            <span class="k">if</span> <span class="n">isImageType</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
</span><span id="MapImage.paste-1822"><a href="#MapImage.paste-1822"><span class="linenos">1822</span></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span>
</span><span id="MapImage.paste-1823"><a href="#MapImage.paste-1823"><span class="linenos">1823</span></a>            <span class="k">elif</span> <span class="n">isImageType</span><span class="p">(</span><span class="n">mask</span><span class="p">):</span>
</span><span id="MapImage.paste-1824"><a href="#MapImage.paste-1824"><span class="linenos">1824</span></a>                <span class="n">size</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">size</span>
</span><span id="MapImage.paste-1825"><a href="#MapImage.paste-1825"><span class="linenos">1825</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MapImage.paste-1826"><a href="#MapImage.paste-1826"><span class="linenos">1826</span></a>                <span class="c1"># FIXME: use self.size here?</span>
</span><span id="MapImage.paste-1827"><a href="#MapImage.paste-1827"><span class="linenos">1827</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;cannot determine region size; use 4-item box&quot;</span>
</span><span id="MapImage.paste-1828"><a href="#MapImage.paste-1828"><span class="linenos">1828</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="MapImage.paste-1829"><a href="#MapImage.paste-1829"><span class="linenos">1829</span></a>            <span class="n">box</span> <span class="o">+=</span> <span class="p">(</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MapImage.paste-1830"><a href="#MapImage.paste-1830"><span class="linenos">1830</span></a>
</span><span id="MapImage.paste-1831"><a href="#MapImage.paste-1831"><span class="linenos">1831</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MapImage.paste-1832"><a href="#MapImage.paste-1832"><span class="linenos">1832</span></a>            <span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">ImageColor</span>
</span><span id="MapImage.paste-1833"><a href="#MapImage.paste-1833"><span class="linenos">1833</span></a>
</span><span id="MapImage.paste-1834"><a href="#MapImage.paste-1834"><span class="linenos">1834</span></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ImageColor</span><span class="o">.</span><span class="n">getcolor</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
</span><span id="MapImage.paste-1835"><a href="#MapImage.paste-1835"><span class="linenos">1835</span></a>
</span><span id="MapImage.paste-1836"><a href="#MapImage.paste-1836"><span class="linenos">1836</span></a>        <span class="k">elif</span> <span class="n">isImageType</span><span class="p">(</span><span class="n">im</span><span class="p">):</span>
</span><span id="MapImage.paste-1837"><a href="#MapImage.paste-1837"><span class="linenos">1837</span></a>            <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="MapImage.paste-1838"><a href="#MapImage.paste-1838"><span class="linenos">1838</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
</span><span id="MapImage.paste-1839"><a href="#MapImage.paste-1839"><span class="linenos">1839</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;RGB&quot;</span> <span class="ow">or</span> <span class="n">im</span><span class="o">.</span><span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="s2">&quot;RGBA&quot;</span><span class="p">,</span> <span class="s2">&quot;RGBa&quot;</span><span class="p">):</span>
</span><span id="MapImage.paste-1840"><a href="#MapImage.paste-1840"><span class="linenos">1840</span></a>                    <span class="c1"># should use an adapter for this!</span>
</span><span id="MapImage.paste-1841"><a href="#MapImage.paste-1841"><span class="linenos">1841</span></a>                    <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
</span><span id="MapImage.paste-1842"><a href="#MapImage.paste-1842"><span class="linenos">1842</span></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">im</span>
</span><span id="MapImage.paste-1843"><a href="#MapImage.paste-1843"><span class="linenos">1843</span></a>
</span><span id="MapImage.paste-1844"><a href="#MapImage.paste-1844"><span class="linenos">1844</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_mutable</span><span class="p">()</span>
</span><span id="MapImage.paste-1845"><a href="#MapImage.paste-1845"><span class="linenos">1845</span></a>
</span><span id="MapImage.paste-1846"><a href="#MapImage.paste-1846"><span class="linenos">1846</span></a>        <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
</span><span id="MapImage.paste-1847"><a href="#MapImage.paste-1847"><span class="linenos">1847</span></a>            <span class="n">mask</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</span><span id="MapImage.paste-1848"><a href="#MapImage.paste-1848"><span class="linenos">1848</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">im</span><span class="p">)</span>
</span><span id="MapImage.paste-1849"><a href="#MapImage.paste-1849"><span class="linenos">1849</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MapImage.paste-1850"><a href="#MapImage.paste-1850"><span class="linenos">1850</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">im</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Pastes another image into this image. The box argument is either
a 2-tuple giving the upper left corner, a 4-tuple defining the
left, upper, right, and lower pixel coordinate, or None (same as
(0, 0)). See :ref:<code>coordinate-system</code>. If a 4-tuple is given, the size
of the pasted image must match the size of the region.</p>

<p>If the modes don't match, the pasted image is converted to the mode of
this image (see the <code>~PIL.Image.Image.convert()</code> method for
details).</p>

<p>Instead of an image, the source can be a integer or tuple
containing pixel values.  The method then fills the region
with the given color.  When creating RGB images, you can
also use color strings as supported by the ImageColor module.</p>

<p>If a mask is given, this method updates only the regions
indicated by the mask. You can use either "1", "L", "LA", "RGBA"
or "RGBa" images (if present, the alpha band is used as mask).
Where the mask is 255, the given image is copied as is.  Where
the mask is 0, the current value is preserved.  Intermediate
values will mix the two images together, including their alpha
channels if they have them.</p>

<p>See <code>~PIL.Image.Image.alpha_composite()</code> if you want to
combine images with respect to their alpha channels.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>im</strong>:  Source image or pixel value (integer, float or tuple).</li>
<li><p><strong>box</strong>:  An optional 4-tuple giving the region to paste into.
If a 2-tuple is used instead, it's treated as the upper left
corner.  If omitted or None, the source is pasted into the
upper left corner.</p>

<p>If an image is given as the second argument and there is no
third, the box defaults to (0, 0), and the second argument
is interpreted as a mask image.</p></li>
<li><strong>mask</strong>:  An optional mask image.</li>
</ul>
</div>


                            </div>
                            <div id="MapImage.save" class="classattr">
                                        <input id="MapImage.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span> <span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]]</span>,</span><span class="param">	<span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="MapImage.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.save-2482"><a href="#MapImage.save-2482"><span class="linenos">2482</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span>
</span><span id="MapImage.save-2483"><a href="#MapImage.save-2483"><span class="linenos">2483</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">StrOrBytesPath</span> <span class="o">|</span> <span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span>
</span><span id="MapImage.save-2484"><a href="#MapImage.save-2484"><span class="linenos">2484</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MapImage.save-2485"><a href="#MapImage.save-2485"><span class="linenos">2485</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MapImage.save-2486"><a href="#MapImage.save-2486"><span class="linenos">2486</span></a><span class="sd">        Saves this image under the given filename.  If no format is</span>
</span><span id="MapImage.save-2487"><a href="#MapImage.save-2487"><span class="linenos">2487</span></a><span class="sd">        specified, the format to use is determined from the filename</span>
</span><span id="MapImage.save-2488"><a href="#MapImage.save-2488"><span class="linenos">2488</span></a><span class="sd">        extension, if possible.</span>
</span><span id="MapImage.save-2489"><a href="#MapImage.save-2489"><span class="linenos">2489</span></a>
</span><span id="MapImage.save-2490"><a href="#MapImage.save-2490"><span class="linenos">2490</span></a><span class="sd">        Keyword options can be used to provide additional instructions</span>
</span><span id="MapImage.save-2491"><a href="#MapImage.save-2491"><span class="linenos">2491</span></a><span class="sd">        to the writer. If a writer doesn&#39;t recognise an option, it is</span>
</span><span id="MapImage.save-2492"><a href="#MapImage.save-2492"><span class="linenos">2492</span></a><span class="sd">        silently ignored. The available options are described in the</span>
</span><span id="MapImage.save-2493"><a href="#MapImage.save-2493"><span class="linenos">2493</span></a><span class="sd">        :doc:`image format documentation</span>
</span><span id="MapImage.save-2494"><a href="#MapImage.save-2494"><span class="linenos">2494</span></a><span class="sd">        &lt;../handbook/image-file-formats&gt;` for each writer.</span>
</span><span id="MapImage.save-2495"><a href="#MapImage.save-2495"><span class="linenos">2495</span></a>
</span><span id="MapImage.save-2496"><a href="#MapImage.save-2496"><span class="linenos">2496</span></a><span class="sd">        You can use a file object instead of a filename. In this case,</span>
</span><span id="MapImage.save-2497"><a href="#MapImage.save-2497"><span class="linenos">2497</span></a><span class="sd">        you must always specify the format. The file object must</span>
</span><span id="MapImage.save-2498"><a href="#MapImage.save-2498"><span class="linenos">2498</span></a><span class="sd">        implement the ``seek``, ``tell``, and ``write``</span>
</span><span id="MapImage.save-2499"><a href="#MapImage.save-2499"><span class="linenos">2499</span></a><span class="sd">        methods, and be opened in binary mode.</span>
</span><span id="MapImage.save-2500"><a href="#MapImage.save-2500"><span class="linenos">2500</span></a>
</span><span id="MapImage.save-2501"><a href="#MapImage.save-2501"><span class="linenos">2501</span></a><span class="sd">        :param fp: A filename (string), os.PathLike object or file object.</span>
</span><span id="MapImage.save-2502"><a href="#MapImage.save-2502"><span class="linenos">2502</span></a><span class="sd">        :param format: Optional format override.  If omitted, the</span>
</span><span id="MapImage.save-2503"><a href="#MapImage.save-2503"><span class="linenos">2503</span></a><span class="sd">           format to use is determined from the filename extension.</span>
</span><span id="MapImage.save-2504"><a href="#MapImage.save-2504"><span class="linenos">2504</span></a><span class="sd">           If a file object was used instead of a filename, this</span>
</span><span id="MapImage.save-2505"><a href="#MapImage.save-2505"><span class="linenos">2505</span></a><span class="sd">           parameter should always be used.</span>
</span><span id="MapImage.save-2506"><a href="#MapImage.save-2506"><span class="linenos">2506</span></a><span class="sd">        :param params: Extra parameters to the image writer.</span>
</span><span id="MapImage.save-2507"><a href="#MapImage.save-2507"><span class="linenos">2507</span></a><span class="sd">        :returns: None</span>
</span><span id="MapImage.save-2508"><a href="#MapImage.save-2508"><span class="linenos">2508</span></a><span class="sd">        :exception ValueError: If the output format could not be determined</span>
</span><span id="MapImage.save-2509"><a href="#MapImage.save-2509"><span class="linenos">2509</span></a><span class="sd">           from the file name.  Use the format option to solve this.</span>
</span><span id="MapImage.save-2510"><a href="#MapImage.save-2510"><span class="linenos">2510</span></a><span class="sd">        :exception OSError: If the file could not be written.  The file</span>
</span><span id="MapImage.save-2511"><a href="#MapImage.save-2511"><span class="linenos">2511</span></a><span class="sd">           may have been created, and may contain partial data.</span>
</span><span id="MapImage.save-2512"><a href="#MapImage.save-2512"><span class="linenos">2512</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage.save-2513"><a href="#MapImage.save-2513"><span class="linenos">2513</span></a>
</span><span id="MapImage.save-2514"><a href="#MapImage.save-2514"><span class="linenos">2514</span></a>        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="MapImage.save-2515"><a href="#MapImage.save-2515"><span class="linenos">2515</span></a>        <span class="n">open_fp</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MapImage.save-2516"><a href="#MapImage.save-2516"><span class="linenos">2516</span></a>        <span class="k">if</span> <span class="n">is_path</span><span class="p">(</span><span class="n">fp</span><span class="p">):</span>
</span><span id="MapImage.save-2517"><a href="#MapImage.save-2517"><span class="linenos">2517</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fspath</span><span class="p">(</span><span class="n">fp</span><span class="p">))</span>
</span><span id="MapImage.save-2518"><a href="#MapImage.save-2518"><span class="linenos">2518</span></a>            <span class="n">open_fp</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MapImage.save-2519"><a href="#MapImage.save-2519"><span class="linenos">2519</span></a>        <span class="k">elif</span> <span class="n">fp</span> <span class="o">==</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">:</span>
</span><span id="MapImage.save-2520"><a href="#MapImage.save-2520"><span class="linenos">2520</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="MapImage.save-2521"><a href="#MapImage.save-2521"><span class="linenos">2521</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span>
</span><span id="MapImage.save-2522"><a href="#MapImage.save-2522"><span class="linenos">2522</span></a>            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="MapImage.save-2523"><a href="#MapImage.save-2523"><span class="linenos">2523</span></a>                <span class="k">pass</span>
</span><span id="MapImage.save-2524"><a href="#MapImage.save-2524"><span class="linenos">2524</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_path</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
</span><span id="MapImage.save-2525"><a href="#MapImage.save-2525"><span class="linenos">2525</span></a>            <span class="c1"># only set the name for metadata purposes</span>
</span><span id="MapImage.save-2526"><a href="#MapImage.save-2526"><span class="linenos">2526</span></a>            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">fspath</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</span><span id="MapImage.save-2527"><a href="#MapImage.save-2527"><span class="linenos">2527</span></a>
</span><span id="MapImage.save-2528"><a href="#MapImage.save-2528"><span class="linenos">2528</span></a>        <span class="c1"># may mutate self!</span>
</span><span id="MapImage.save-2529"><a href="#MapImage.save-2529"><span class="linenos">2529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_mutable</span><span class="p">()</span>
</span><span id="MapImage.save-2530"><a href="#MapImage.save-2530"><span class="linenos">2530</span></a>
</span><span id="MapImage.save-2531"><a href="#MapImage.save-2531"><span class="linenos">2531</span></a>        <span class="n">save_all</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;save_all&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="MapImage.save-2532"><a href="#MapImage.save-2532"><span class="linenos">2532</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoderinfo</span> <span class="o">=</span> <span class="n">params</span>
</span><span id="MapImage.save-2533"><a href="#MapImage.save-2533"><span class="linenos">2533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoderconfig</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
</span><span id="MapImage.save-2534"><a href="#MapImage.save-2534"><span class="linenos">2534</span></a>
</span><span id="MapImage.save-2535"><a href="#MapImage.save-2535"><span class="linenos">2535</span></a>        <span class="n">preinit</span><span class="p">()</span>
</span><span id="MapImage.save-2536"><a href="#MapImage.save-2536"><span class="linenos">2536</span></a>
</span><span id="MapImage.save-2537"><a href="#MapImage.save-2537"><span class="linenos">2537</span></a>        <span class="n">filename_ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</span><span id="MapImage.save-2538"><a href="#MapImage.save-2538"><span class="linenos">2538</span></a>        <span class="n">ext</span> <span class="o">=</span> <span class="n">filename_ext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename_ext</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">filename_ext</span>
</span><span id="MapImage.save-2539"><a href="#MapImage.save-2539"><span class="linenos">2539</span></a>
</span><span id="MapImage.save-2540"><a href="#MapImage.save-2540"><span class="linenos">2540</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">format</span><span class="p">:</span>
</span><span id="MapImage.save-2541"><a href="#MapImage.save-2541"><span class="linenos">2541</span></a>            <span class="k">if</span> <span class="n">ext</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">EXTENSION</span><span class="p">:</span>
</span><span id="MapImage.save-2542"><a href="#MapImage.save-2542"><span class="linenos">2542</span></a>                <span class="n">init</span><span class="p">()</span>
</span><span id="MapImage.save-2543"><a href="#MapImage.save-2543"><span class="linenos">2543</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="MapImage.save-2544"><a href="#MapImage.save-2544"><span class="linenos">2544</span></a>                <span class="nb">format</span> <span class="o">=</span> <span class="n">EXTENSION</span><span class="p">[</span><span class="n">ext</span><span class="p">]</span>
</span><span id="MapImage.save-2545"><a href="#MapImage.save-2545"><span class="linenos">2545</span></a>            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="MapImage.save-2546"><a href="#MapImage.save-2546"><span class="linenos">2546</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;unknown file extension: </span><span class="si">{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="MapImage.save-2547"><a href="#MapImage.save-2547"><span class="linenos">2547</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
</span><span id="MapImage.save-2548"><a href="#MapImage.save-2548"><span class="linenos">2548</span></a>
</span><span id="MapImage.save-2549"><a href="#MapImage.save-2549"><span class="linenos">2549</span></a>        <span class="k">if</span> <span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SAVE</span><span class="p">:</span>
</span><span id="MapImage.save-2550"><a href="#MapImage.save-2550"><span class="linenos">2550</span></a>            <span class="n">init</span><span class="p">()</span>
</span><span id="MapImage.save-2551"><a href="#MapImage.save-2551"><span class="linenos">2551</span></a>        <span class="k">if</span> <span class="n">save_all</span><span class="p">:</span>
</span><span id="MapImage.save-2552"><a href="#MapImage.save-2552"><span class="linenos">2552</span></a>            <span class="n">save_handler</span> <span class="o">=</span> <span class="n">SAVE_ALL</span><span class="p">[</span><span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
</span><span id="MapImage.save-2553"><a href="#MapImage.save-2553"><span class="linenos">2553</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MapImage.save-2554"><a href="#MapImage.save-2554"><span class="linenos">2554</span></a>            <span class="n">save_handler</span> <span class="o">=</span> <span class="n">SAVE</span><span class="p">[</span><span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
</span><span id="MapImage.save-2555"><a href="#MapImage.save-2555"><span class="linenos">2555</span></a>
</span><span id="MapImage.save-2556"><a href="#MapImage.save-2556"><span class="linenos">2556</span></a>        <span class="n">created</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MapImage.save-2557"><a href="#MapImage.save-2557"><span class="linenos">2557</span></a>        <span class="k">if</span> <span class="n">open_fp</span><span class="p">:</span>
</span><span id="MapImage.save-2558"><a href="#MapImage.save-2558"><span class="linenos">2558</span></a>            <span class="n">created</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="MapImage.save-2559"><a href="#MapImage.save-2559"><span class="linenos">2559</span></a>            <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;append&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="MapImage.save-2560"><a href="#MapImage.save-2560"><span class="linenos">2560</span></a>                <span class="c1"># Open also for reading (&quot;+&quot;), because TIFF save_all</span>
</span><span id="MapImage.save-2561"><a href="#MapImage.save-2561"><span class="linenos">2561</span></a>                <span class="c1"># writer needs to go back and edit the written data.</span>
</span><span id="MapImage.save-2562"><a href="#MapImage.save-2562"><span class="linenos">2562</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;r+b&quot;</span><span class="p">)</span>
</span><span id="MapImage.save-2563"><a href="#MapImage.save-2563"><span class="linenos">2563</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MapImage.save-2564"><a href="#MapImage.save-2564"><span class="linenos">2564</span></a>                <span class="n">fp</span> <span class="o">=</span> <span class="n">builtins</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;w+b&quot;</span><span class="p">)</span>
</span><span id="MapImage.save-2565"><a href="#MapImage.save-2565"><span class="linenos">2565</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MapImage.save-2566"><a href="#MapImage.save-2566"><span class="linenos">2566</span></a>            <span class="n">fp</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span> <span class="n">fp</span><span class="p">)</span>
</span><span id="MapImage.save-2567"><a href="#MapImage.save-2567"><span class="linenos">2567</span></a>
</span><span id="MapImage.save-2568"><a href="#MapImage.save-2568"><span class="linenos">2568</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MapImage.save-2569"><a href="#MapImage.save-2569"><span class="linenos">2569</span></a>            <span class="n">save_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span><span id="MapImage.save-2570"><a href="#MapImage.save-2570"><span class="linenos">2570</span></a>        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="MapImage.save-2571"><a href="#MapImage.save-2571"><span class="linenos">2571</span></a>            <span class="k">if</span> <span class="n">open_fp</span><span class="p">:</span>
</span><span id="MapImage.save-2572"><a href="#MapImage.save-2572"><span class="linenos">2572</span></a>                <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="MapImage.save-2573"><a href="#MapImage.save-2573"><span class="linenos">2573</span></a>            <span class="k">if</span> <span class="n">created</span><span class="p">:</span>
</span><span id="MapImage.save-2574"><a href="#MapImage.save-2574"><span class="linenos">2574</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="MapImage.save-2575"><a href="#MapImage.save-2575"><span class="linenos">2575</span></a>                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="MapImage.save-2576"><a href="#MapImage.save-2576"><span class="linenos">2576</span></a>                <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
</span><span id="MapImage.save-2577"><a href="#MapImage.save-2577"><span class="linenos">2577</span></a>                    <span class="k">pass</span>
</span><span id="MapImage.save-2578"><a href="#MapImage.save-2578"><span class="linenos">2578</span></a>            <span class="k">raise</span>
</span><span id="MapImage.save-2579"><a href="#MapImage.save-2579"><span class="linenos">2579</span></a>        <span class="k">if</span> <span class="n">open_fp</span><span class="p">:</span>
</span><span id="MapImage.save-2580"><a href="#MapImage.save-2580"><span class="linenos">2580</span></a>            <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Saves this image under the given filename.  If no format is
specified, the format to use is determined from the filename
extension, if possible.</p>

<p>Keyword options can be used to provide additional instructions
to the writer. If a writer doesn't recognise an option, it is
silently ignored. The available options are described in the
:doc:<code>image format documentation
&lt;../handbook/image-file-formats&gt;</code> for each writer.</p>

<p>You can use a file object instead of a filename. In this case,
you must always specify the format. The file object must
implement the <code>seek</code>, <code>tell</code>, and <code>write</code>
methods, and be opened in binary mode.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>fp</strong>:  A filename (string), os.PathLike object or file object.</li>
<li><strong>format</strong>:  Optional format override.  If omitted, the
format to use is determined from the filename extension.
If a file object was used instead of a filename, this
parameter should always be used.</li>
<li><strong>params</strong>:  Extra parameters to the image writer.
:returns: None
:exception ValueError: If the output format could not be determined
from the file name.  Use the format option to solve this.
:exception OSError: If the file could not be written.  The file
may have been created, and may contain partial data.</li>
</ul>
</div>


                            </div>
                            <div id="MapImage.crop" class="classattr">
                                        <input id="MapImage.crop-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">crop</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">box</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n"><a href="#MapImage">MapImage</a></span>:</span></span>

                <label class="view-source-button" for="MapImage.crop-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.crop"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.crop-155"><a href="#MapImage.crop-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">crop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">Rectangle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage.crop-156"><a href="#MapImage.crop-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a cropped portion of the original image, along with an accordingly updated `game_zero` property.&quot;&quot;&quot;</span>
</span><span id="MapImage.crop-157"><a href="#MapImage.crop-157"><span class="linenos">157</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">-</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a cropped portion of the original image, along with an accordingly updated <code><a href="#MapImage.game_zero">game_zero</a></code> property.</p>
</div>


                            </div>
                            <div id="MapImage.resize_canvas" class="classattr">
                                        <input id="MapImage.resize_canvas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resize_canvas</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">width</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">height</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">center_on</span><span class="p">:</span> <span class="n"><a href="#GameCoord">GameCoord</a></span> <span class="o">=</span> <span class="n">GameCoord</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></span><span class="return-annotation">) -> <span class="n"><a href="#MapImage">MapImage</a></span>:</span></span>

                <label class="view-source-button" for="MapImage.resize_canvas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MapImage.resize_canvas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MapImage.resize_canvas-159"><a href="#MapImage.resize_canvas-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">resize_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">center_on</span><span class="p">:</span> <span class="n">GameCoord</span><span class="o">=</span><span class="n">GameCoord</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="s1">&#39;MapImage&#39;</span><span class="p">:</span>
</span><span id="MapImage.resize_canvas-160"><a href="#MapImage.resize_canvas-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns this image centered within a new canvas of the given size,</span>
</span><span id="MapImage.resize_canvas-161"><a href="#MapImage.resize_canvas-161"><span class="linenos">161</span></a><span class="sd">        centered by a specified coordinate of the original image.</span>
</span><span id="MapImage.resize_canvas-162"><a href="#MapImage.resize_canvas-162"><span class="linenos">162</span></a>
</span><span id="MapImage.resize_canvas-163"><a href="#MapImage.resize_canvas-163"><span class="linenos">163</span></a><span class="sd">        :param center_on: What coordinate of the Minecraft world to center the image on. Defaults to 0,0.</span>
</span><span id="MapImage.resize_canvas-164"><a href="#MapImage.resize_canvas-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MapImage.resize_canvas-165"><a href="#MapImage.resize_canvas-165"><span class="linenos">165</span></a>        <span class="n">origin_in_image</span> <span class="o">=</span> <span class="n">center_on</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="MapImage.resize_canvas-166"><a href="#MapImage.resize_canvas-166"><span class="linenos">166</span></a>        <span class="n">center_distance</span> <span class="o">=</span> <span class="n">origin_in_image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="n">origin_in_image</span>
</span><span id="MapImage.resize_canvas-167"><a href="#MapImage.resize_canvas-167"><span class="linenos">167</span></a>        <span class="n">paste_area</span><span class="p">:</span> <span class="n">Rectangle</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MapImage.resize_canvas-168"><a href="#MapImage.resize_canvas-168"><span class="linenos">168</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="MapImage.resize_canvas-169"><a href="#MapImage.resize_canvas-169"><span class="linenos">169</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="MapImage.resize_canvas-170"><a href="#MapImage.resize_canvas-170"><span class="linenos">170</span></a>            <span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
</span><span id="MapImage.resize_canvas-171"><a href="#MapImage.resize_canvas-171"><span class="linenos">171</span></a>            <span class="p">(</span><span class="n">height</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">center_distance</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="MapImage.resize_canvas-172"><a href="#MapImage.resize_canvas-172"><span class="linenos">172</span></a>        <span class="p">)</span>
</span><span id="MapImage.resize_canvas-173"><a href="#MapImage.resize_canvas-173"><span class="linenos">173</span></a>        <span class="n">new_canvas</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>
</span><span id="MapImage.resize_canvas-174"><a href="#MapImage.resize_canvas-174"><span class="linenos">174</span></a>        <span class="n">new_canvas</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">img</span><span class="p">,</span> <span class="n">paste_area</span><span class="p">)</span>
</span><span id="MapImage.resize_canvas-175"><a href="#MapImage.resize_canvas-175"><span class="linenos">175</span></a>        <span class="k">return</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">new_canvas</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">game_zero</span> <span class="o">+</span> <span class="n">paste_area</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns this image centered within a new canvas of the given size,
centered by a specified coordinate of the original image.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>center_on</strong>:  What coordinate of the Minecraft world to center the image on. Defaults to 0,0.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="CombinerStyle">
                            <input id="CombinerStyle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">CombinerStyle</span>:

                <label class="view-source-button" for="CombinerStyle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CombinerStyle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CombinerStyle-177"><a href="#CombinerStyle-177"><span class="linenos">177</span></a><span class="nd">@dataclass</span>
</span><span id="CombinerStyle-178"><a href="#CombinerStyle-178"><span class="linenos">178</span></a><span class="k">class</span> <span class="nc">CombinerStyle</span><span class="p">:</span>
</span><span id="CombinerStyle-179"><a href="#CombinerStyle-179"><span class="linenos">179</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines styling rules for `Combiner`-generated map images.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-180"><a href="#CombinerStyle-180"><span class="linenos">180</span></a>
</span><span id="CombinerStyle-181"><a href="#CombinerStyle-181"><span class="linenos">181</span></a>    <span class="n">background_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="CombinerStyle-182"><a href="#CombinerStyle-182"><span class="linenos">182</span></a>    <span class="n">grid_color</span><span class="p">:</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="CombinerStyle-183"><a href="#CombinerStyle-183"><span class="linenos">183</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Used as the base for any grid-related colors.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-184"><a href="#CombinerStyle-184"><span class="linenos">184</span></a>    <span class="n">show_grid_lines</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span>
</span><span id="CombinerStyle-185"><a href="#CombinerStyle-185"><span class="linenos">185</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw grid lines at the intervals set in the `Combiner` instance. If no interval is set, this is ignored.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-186"><a href="#CombinerStyle-186"><span class="linenos">186</span></a>    <span class="n">grid_line_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Color</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CombinerStyle-187"><a href="#CombinerStyle-187"><span class="linenos">187</span></a>
</span><span id="CombinerStyle-188"><a href="#CombinerStyle-188"><span class="linenos">188</span></a>    <span class="n">show_grid_text</span><span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">True</span>
</span><span id="CombinerStyle-189"><a href="#CombinerStyle-189"><span class="linenos">189</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Draw grid coordinates at the intervals set in the `Combiner` instance. If no interval is set, this is ignored.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-190"><a href="#CombinerStyle-190"><span class="linenos">190</span></a>    <span class="n">grid_text_font</span><span class="p">:</span> <span class="nb">str</span>   <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>
</span><span id="CombinerStyle-191"><a href="#CombinerStyle-191"><span class="linenos">191</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Name of a font to use for drawing coordinate text onto the image.</span>
</span><span id="CombinerStyle-192"><a href="#CombinerStyle-192"><span class="linenos">192</span></a><span class="sd">    Can either be the name of a system-installed font - e.g. &quot;arial&quot; - or a path to a font file - e.g. &quot;documents/my_font.otf&quot;.</span>
</span><span id="CombinerStyle-193"><a href="#CombinerStyle-193"><span class="linenos">193</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CombinerStyle-194"><a href="#CombinerStyle-194"><span class="linenos">194</span></a>    <span class="n">grid_text_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Color</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CombinerStyle-195"><a href="#CombinerStyle-195"><span class="linenos">195</span></a>    <span class="n">grid_text_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span>
</span><span id="CombinerStyle-196"><a href="#CombinerStyle-196"><span class="linenos">196</span></a>
</span><span id="CombinerStyle-197"><a href="#CombinerStyle-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="CombinerStyle-198"><a href="#CombinerStyle-198"><span class="linenos">198</span></a>        <span class="c1"># Force type conversion and validation</span>
</span><span id="CombinerStyle-199"><a href="#CombinerStyle-199"><span class="linenos">199</span></a>        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">cast</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="c1"># pylint: disable=no-member; false positive, __annotations__ is valid</span>
</span><span id="CombinerStyle-200"><a href="#CombinerStyle-200"><span class="linenos">200</span></a>            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
</span><span id="CombinerStyle-201"><a href="#CombinerStyle-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;typing.Optional&#39;</span><span class="p">):</span>
</span><span id="CombinerStyle-202"><a href="#CombinerStyle-202"><span class="linenos">202</span></a>                <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CombinerStyle-203"><a href="#CombinerStyle-203"><span class="linenos">203</span></a>                    <span class="k">continue</span>
</span><span id="CombinerStyle-204"><a href="#CombinerStyle-204"><span class="linenos">204</span></a>                <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">(</span><span class="bp">cls</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CombinerStyle-205"><a href="#CombinerStyle-205"><span class="linenos">205</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
</span><span id="CombinerStyle-206"><a href="#CombinerStyle-206"><span class="linenos">206</span></a>                <span class="k">continue</span>
</span><span id="CombinerStyle-207"><a href="#CombinerStyle-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="n">Color</span><span class="p">:</span>
</span><span id="CombinerStyle-208"><a href="#CombinerStyle-208"><span class="linenos">208</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CombinerStyle-209"><a href="#CombinerStyle-209"><span class="linenos">209</span></a>                    <span class="k">if</span> <span class="n">hexcode</span> <span class="o">:=</span> <span class="n">Color</span><span class="o">.</span><span class="n">ensure_hex_format</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span><span id="CombinerStyle-210"><a href="#CombinerStyle-210"><span class="linenos">210</span></a>                        <span class="n">val</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">from_hex</span><span class="p">(</span><span class="n">hexcode</span><span class="p">)</span>
</span><span id="CombinerStyle-211"><a href="#CombinerStyle-211"><span class="linenos">211</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="CombinerStyle-212"><a href="#CombinerStyle-212"><span class="linenos">212</span></a>                        <span class="n">val</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">from_name</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="CombinerStyle-213"><a href="#CombinerStyle-213"><span class="linenos">213</span></a>                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
</span><span id="CombinerStyle-214"><a href="#CombinerStyle-214"><span class="linenos">214</span></a>                    <span class="n">val</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">val</span><span class="p">)</span>
</span><span id="CombinerStyle-215"><a href="#CombinerStyle-215"><span class="linenos">215</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="CombinerStyle-216"><a href="#CombinerStyle-216"><span class="linenos">216</span></a>                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Invalid type given for Color construction: </span><span class="si">{</span><span class="n">val</span><span class="si">!r}</span><span class="s1"> is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="CombinerStyle-217"><a href="#CombinerStyle-217"><span class="linenos">217</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="CombinerStyle-218"><a href="#CombinerStyle-218"><span class="linenos">218</span></a>                <span class="n">val</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span id="CombinerStyle-219"><a href="#CombinerStyle-219"><span class="linenos">219</span></a>            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="CombinerStyle-220"><a href="#CombinerStyle-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_line_color</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span>
</span><span id="CombinerStyle-221"><a href="#CombinerStyle-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_text_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_text_color</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_color</span>
</span><span id="CombinerStyle-222"><a href="#CombinerStyle-222"><span class="linenos">222</span></a>
</span><span id="CombinerStyle-223"><a href="#CombinerStyle-223"><span class="linenos">223</span></a>    <span class="nd">@classmethod</span>
</span><span id="CombinerStyle-224"><a href="#CombinerStyle-224"><span class="linenos">224</span></a>    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_str_or_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="CombinerStyle-225"><a href="#CombinerStyle-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a `CombinerStyle` instance from a JSON file path, or a JSON-formatted string.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-226"><a href="#CombinerStyle-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="CombinerStyle-227"><a href="#CombinerStyle-227"><span class="linenos">227</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CombinerStyle-228"><a href="#CombinerStyle-228"><span class="linenos">228</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="CombinerStyle-229"><a href="#CombinerStyle-229"><span class="linenos">229</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CombinerStyle-230"><a href="#CombinerStyle-230"><span class="linenos">230</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span>
</span><span id="CombinerStyle-231"><a href="#CombinerStyle-231"><span class="linenos">231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CombinerStyle-232"><a href="#CombinerStyle-232"><span class="linenos">232</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json_str_or_path</span><span class="si">!r}</span><span class="s1"> is not a file or could not be found&#39;</span><span class="p">)</span>
</span><span id="CombinerStyle-233"><a href="#CombinerStyle-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
</span><span id="CombinerStyle-234"><a href="#CombinerStyle-234"><span class="linenos">234</span></a>
</span><span id="CombinerStyle-235"><a href="#CombinerStyle-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CombinerStyle-236"><a href="#CombinerStyle-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Dumps this object as a JSON string.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle-237"><a href="#CombinerStyle-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">StyleJSONEncoder</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Defines styling rules for <code><a href="#Combiner">Combiner</a></code>-generated map images.</p>
</div>


                            <div id="CombinerStyle.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">CombinerStyle</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">background_color</span><span class="p">:</span> <span class="n"><a href="helper.html#Color">squaremap_combine.helper.Color</a></span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>,</span><span class="param">	<span class="n">grid_color</span><span class="p">:</span> <span class="n"><a href="helper.html#Color">squaremap_combine.helper.Color</a></span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>,</span><span class="param">	<span class="n">show_grid_lines</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">grid_line_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="helper.html#Color">squaremap_combine.helper.Color</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">show_grid_text</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">grid_text_font</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;arial&#39;</span>,</span><span class="param">	<span class="n">grid_text_color</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n"><a href="helper.html#Color">squaremap_combine.helper.Color</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">grid_text_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.__init__"></a>
    
    

                            </div>
                            <div id="CombinerStyle.background_color" class="classattr">
                                <div class="attr variable">
            <span class="name">background_color</span><span class="annotation">: <a href="helper.html#Color">squaremap_combine.helper.Color</a></span>        =
<span class="default_value">Color(red=0, green=0, blue=0, alpha=0)</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.background_color"></a>
    
    

                            </div>
                            <div id="CombinerStyle.grid_color" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_color</span><span class="annotation">: <a href="helper.html#Color">squaremap_combine.helper.Color</a></span>        =
<span class="default_value">Color(red=0, green=0, blue=0, alpha=255)</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.grid_color"></a>
    
            <div class="docstring"><p>Used as the base for any grid-related colors.</p>
</div>


                            </div>
                            <div id="CombinerStyle.show_grid_lines" class="classattr">
                                <div class="attr variable">
            <span class="name">show_grid_lines</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.show_grid_lines"></a>
    
            <div class="docstring"><p>Draw grid lines at the intervals set in the <code><a href="#Combiner">Combiner</a></code> instance. If no interval is set, this is ignored.</p>
</div>


                            </div>
                            <div id="CombinerStyle.grid_line_color" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_line_color</span><span class="annotation">: Optional[<a href="helper.html#Color">squaremap_combine.helper.Color</a>]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.grid_line_color"></a>
    
    

                            </div>
                            <div id="CombinerStyle.show_grid_text" class="classattr">
                                <div class="attr variable">
            <span class="name">show_grid_text</span><span class="annotation">: bool</span>        =
<span class="default_value">True</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.show_grid_text"></a>
    
            <div class="docstring"><p>Draw grid coordinates at the intervals set in the <code><a href="#Combiner">Combiner</a></code> instance. If no interval is set, this is ignored.</p>
</div>


                            </div>
                            <div id="CombinerStyle.grid_text_font" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_text_font</span><span class="annotation">: str</span>        =
<span class="default_value">&#39;arial&#39;</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.grid_text_font"></a>
    
            <div class="docstring"><p>Name of a font to use for drawing coordinate text onto the image.
Can either be the name of a system-installed font - e.g. "arial" - or a path to a font file - e.g. "documents/my_font.otf".</p>
</div>


                            </div>
                            <div id="CombinerStyle.grid_text_color" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_text_color</span><span class="annotation">: Optional[<a href="helper.html#Color">squaremap_combine.helper.Color</a>]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.grid_text_color"></a>
    
    

                            </div>
                            <div id="CombinerStyle.grid_text_size" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_text_size</span><span class="annotation">: int</span>        =
<span class="default_value">12</span>

        
    </div>
    <a class="headerlink" href="#CombinerStyle.grid_text_size"></a>
    
    

                            </div>
                            <div id="CombinerStyle.from_json" class="classattr">
                                        <input id="CombinerStyle.from_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">json_str_or_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span></span><span class="return-annotation">) -> <span class="n">Self</span>:</span></span>

                <label class="view-source-button" for="CombinerStyle.from_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CombinerStyle.from_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CombinerStyle.from_json-223"><a href="#CombinerStyle.from_json-223"><span class="linenos">223</span></a>    <span class="nd">@classmethod</span>
</span><span id="CombinerStyle.from_json-224"><a href="#CombinerStyle.from_json-224"><span class="linenos">224</span></a>    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_str_or_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
</span><span id="CombinerStyle.from_json-225"><a href="#CombinerStyle.from_json-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a `CombinerStyle` instance from a JSON file path, or a JSON-formatted string.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle.from_json-226"><a href="#CombinerStyle.from_json-226"><span class="linenos">226</span></a>        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="CombinerStyle.from_json-227"><a href="#CombinerStyle.from_json-227"><span class="linenos">227</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="CombinerStyle.from_json-228"><a href="#CombinerStyle.from_json-228"><span class="linenos">228</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="CombinerStyle.from_json-229"><a href="#CombinerStyle.from_json-229"><span class="linenos">229</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="CombinerStyle.from_json-230"><a href="#CombinerStyle.from_json-230"><span class="linenos">230</span></a>            <span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str_or_path</span><span class="p">)</span>
</span><span id="CombinerStyle.from_json-231"><a href="#CombinerStyle.from_json-231"><span class="linenos">231</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="CombinerStyle.from_json-232"><a href="#CombinerStyle.from_json-232"><span class="linenos">232</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">json_str_or_path</span><span class="si">!r}</span><span class="s1"> is not a file or could not be found&#39;</span><span class="p">)</span>
</span><span id="CombinerStyle.from_json-233"><a href="#CombinerStyle.from_json-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Creates a <code><a href="#CombinerStyle">CombinerStyle</a></code> instance from a JSON file path, or a JSON-formatted string.</p>
</div>


                            </div>
                            <div id="CombinerStyle.to_json" class="classattr">
                                        <input id="CombinerStyle.to_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="CombinerStyle.to_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CombinerStyle.to_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CombinerStyle.to_json-235"><a href="#CombinerStyle.to_json-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="CombinerStyle.to_json-236"><a href="#CombinerStyle.to_json-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Dumps this object as a JSON string.&quot;&quot;&quot;</span>
</span><span id="CombinerStyle.to_json-237"><a href="#CombinerStyle.to_json-237"><span class="linenos">237</span></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">StyleJSONEncoder</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Dumps this object as a JSON string.</p>
</div>


                            </div>
                </section>
                <section id="DEFAULT_COMBINER_STYLE">
                    <div class="attr variable">
            <span class="name">DEFAULT_COMBINER_STYLE</span>        =
<input id="DEFAULT_COMBINER_STYLE-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="DEFAULT_COMBINER_STYLE-view-value"></label><span class="default_value">CombinerStyle(background_color=Color(red=0, green=0, blue=0, alpha=0), grid_color=Color(red=0, green=0, blue=0, alpha=255), show_grid_lines=True, grid_line_color=Color(red=0, green=0, blue=0, alpha=255), show_grid_text=True, grid_text_font=&#39;arial&#39;, grid_text_color=Color(red=0, green=0, blue=0, alpha=255), grid_text_size=12)</span>

        
    </div>
    <a class="headerlink" href="#DEFAULT_COMBINER_STYLE"></a>
    
    

                </section>
                <section id="Combiner">
                            <input id="Combiner-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Combiner</span>:

                <label class="view-source-button" for="Combiner-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Combiner"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Combiner-241"><a href="#Combiner-241"><span class="linenos">241</span></a><span class="k">class</span> <span class="nc">Combiner</span><span class="p">:</span>
</span><span id="Combiner-242"><a href="#Combiner-242"><span class="linenos">242</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes a squaremap `tiles` directory path, handles calculating rows/columns,</span>
</span><span id="Combiner-243"><a href="#Combiner-243"><span class="linenos">243</span></a><span class="sd">    and is able to export full map images.</span>
</span><span id="Combiner-244"><a href="#Combiner-244"><span class="linenos">244</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Combiner-245"><a href="#Combiner-245"><span class="linenos">245</span></a>    <span class="n">TILE_SIZE</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span>
</span><span id="Combiner-246"><a href="#Combiner-246"><span class="linenos">246</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The size of each tile image in pixels.</span>
</span><span id="Combiner-247"><a href="#Combiner-247"><span class="linenos">247</span></a><span class="sd">    Only made a constant in case squaremap happens to change its image sizes in the future.</span>
</span><span id="Combiner-248"><a href="#Combiner-248"><span class="linenos">248</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Combiner-249"><a href="#Combiner-249"><span class="linenos">249</span></a>    <span class="n">STANDARD_WORLDS</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;overworld&#39;</span><span class="p">,</span> <span class="s1">&#39;the_nether&#39;</span><span class="p">,</span> <span class="s1">&#39;the_end&#39;</span><span class="p">]</span>
</span><span id="Combiner-250"><a href="#Combiner-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Combiner-251"><a href="#Combiner-251"><span class="linenos">251</span></a>            <span class="n">tiles_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="Combiner-252"><a href="#Combiner-252"><span class="linenos">252</span></a>            <span class="n">use_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner-253"><a href="#Combiner-253"><span class="linenos">253</span></a>            <span class="n">skip_confirmation</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner-254"><a href="#Combiner-254"><span class="linenos">254</span></a>            <span class="n">grid_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Combiner-255"><a href="#Combiner-255"><span class="linenos">255</span></a>            <span class="n">grid_coords_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">DEFAULT_COORDS_FORMAT</span><span class="p">,</span>
</span><span id="Combiner-256"><a href="#Combiner-256"><span class="linenos">256</span></a>            <span class="n">style</span><span class="p">:</span> <span class="n">CombinerStyle</span><span class="o">=</span><span class="n">DEFAULT_COMBINER_STYLE</span>
</span><span id="Combiner-257"><a href="#Combiner-257"><span class="linenos">257</span></a>        <span class="p">):</span>
</span><span id="Combiner-258"><a href="#Combiner-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Combiner-259"><a href="#Combiner-259"><span class="linenos">259</span></a><span class="sd">        :param tiles_dir: A path to a directory in the same format as what squaremap automatically generates.</span>
</span><span id="Combiner-260"><a href="#Combiner-260"><span class="linenos">260</span></a><span class="sd">            Example:</span>
</span><span id="Combiner-261"><a href="#Combiner-261"><span class="linenos">261</span></a>
</span><span id="Combiner-262"><a href="#Combiner-262"><span class="linenos">262</span></a><span class="sd">        .. code-block:: text</span>
</span><span id="Combiner-263"><a href="#Combiner-263"><span class="linenos">263</span></a><span class="sd">            tiles (&lt;- what this path should point to)</span>
</span><span id="Combiner-264"><a href="#Combiner-264"><span class="linenos">264</span></a><span class="sd">            minecraft_overworld</span>
</span><span id="Combiner-265"><a href="#Combiner-265"><span class="linenos">265</span></a><span class="sd">            |   0</span>
</span><span id="Combiner-266"><a href="#Combiner-266"><span class="linenos">266</span></a><span class="sd">            |   1</span>
</span><span id="Combiner-267"><a href="#Combiner-267"><span class="linenos">267</span></a><span class="sd">            |   2</span>
</span><span id="Combiner-268"><a href="#Combiner-268"><span class="linenos">268</span></a><span class="sd">            |   3</span>
</span><span id="Combiner-269"><a href="#Combiner-269"><span class="linenos">269</span></a><span class="sd">            minecraft_the_nether</span>
</span><span id="Combiner-270"><a href="#Combiner-270"><span class="linenos">270</span></a><span class="sd">            |   0</span>
</span><span id="Combiner-271"><a href="#Combiner-271"><span class="linenos">271</span></a><span class="sd">            |   1</span>
</span><span id="Combiner-272"><a href="#Combiner-272"><span class="linenos">272</span></a><span class="sd">            |   2</span>
</span><span id="Combiner-273"><a href="#Combiner-273"><span class="linenos">273</span></a><span class="sd">            |   3</span>
</span><span id="Combiner-274"><a href="#Combiner-274"><span class="linenos">274</span></a><span class="sd">            minecraft_the_end</span>
</span><span id="Combiner-275"><a href="#Combiner-275"><span class="linenos">275</span></a><span class="sd">                0</span>
</span><span id="Combiner-276"><a href="#Combiner-276"><span class="linenos">276</span></a><span class="sd">                1</span>
</span><span id="Combiner-277"><a href="#Combiner-277"><span class="linenos">277</span></a><span class="sd">                2</span>
</span><span id="Combiner-278"><a href="#Combiner-278"><span class="linenos">278</span></a><span class="sd">                3</span>
</span><span id="Combiner-279"><a href="#Combiner-279"><span class="linenos">279</span></a>
</span><span id="Combiner-280"><a href="#Combiner-280"><span class="linenos">280</span></a><span class="sd">        :param use_tqdm: Whether to show a `tqdm` progress bar for any functions that support it.</span>
</span><span id="Combiner-281"><a href="#Combiner-281"><span class="linenos">281</span></a><span class="sd">        :param skip_confirmation: Whether to skip any confirmation prompts. Setting to `True` allows any function</span>
</span><span id="Combiner-282"><a href="#Combiner-282"><span class="linenos">282</span></a><span class="sd">            in this class to run unattended to.</span>
</span><span id="Combiner-283"><a href="#Combiner-283"><span class="linenos">283</span></a><span class="sd">        :param grid_interval: An X and Y interval that should be used for things like drawing grid lines or coordinates onto \</span>
</span><span id="Combiner-284"><a href="#Combiner-284"><span class="linenos">284</span></a><span class="sd">            the finished image.</span>
</span><span id="Combiner-285"><a href="#Combiner-285"><span class="linenos">285</span></a><span class="sd">        :param grid_coords_format: A format string to be used when drawing grid coordinates. \</span>
</span><span id="Combiner-286"><a href="#Combiner-286"><span class="linenos">286</span></a><span class="sd">            Valid formatting options are `{x}` and {y}`.</span>
</span><span id="Combiner-287"><a href="#Combiner-287"><span class="linenos">287</span></a><span class="sd">        :param style: `CombinerStyle` instance to define styling rules with.</span>
</span><span id="Combiner-288"><a href="#Combiner-288"><span class="linenos">288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner-289"><a href="#Combiner-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tiles_dir</span> <span class="o">:=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tiles_dir</span><span class="p">))</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="Combiner-290"><a href="#Combiner-290"><span class="linenos">290</span></a>            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not a directory: </span><span class="si">{</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner-291"><a href="#Combiner-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span>          <span class="o">=</span> <span class="n">tiles_dir</span>
</span><span id="Combiner-292"><a href="#Combiner-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span>           <span class="o">=</span> <span class="n">use_tqdm</span>
</span><span id="Combiner-293"><a href="#Combiner-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span>  <span class="o">=</span> <span class="n">skip_confirmation</span>
</span><span id="Combiner-294"><a href="#Combiner-294"><span class="linenos">294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span>      <span class="o">=</span> <span class="n">grid_interval</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="Combiner-295"><a href="#Combiner-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span> <span class="o">=</span> <span class="n">grid_coords_format</span>
</span><span id="Combiner-296"><a href="#Combiner-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span>              <span class="o">=</span> <span class="n">style</span>
</span><span id="Combiner-297"><a href="#Combiner-297"><span class="linenos">297</span></a>
</span><span id="Combiner-298"><a href="#Combiner-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tiles_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;minecraft_*/&#39;</span><span class="p">)]</span>
</span><span id="Combiner-299"><a href="#Combiner-299"><span class="linenos">299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;What valid world folders the given `tiles_dir` contains.&quot;&quot;&quot;</span>
</span><span id="Combiner-300"><a href="#Combiner-300"><span class="linenos">300</span></a>
</span><span id="Combiner-301"><a href="#Combiner-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">draw_grid_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner-302"><a href="#Combiner-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws grid lines onto a `MapImage` at the intervals defined for this `Combiner` instance.</span>
</span><span id="Combiner-303"><a href="#Combiner-303"><span class="linenos">303</span></a>
</span><span id="Combiner-304"><a href="#Combiner-304"><span class="linenos">304</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="Combiner-305"><a href="#Combiner-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner-306"><a href="#Combiner-306"><span class="linenos">306</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner-307"><a href="#Combiner-307"><span class="linenos">307</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="Combiner-308"><a href="#Combiner-308"><span class="linenos">308</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Combiner-309"><a href="#Combiner-309"><span class="linenos">309</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner-310"><a href="#Combiner-310"><span class="linenos">310</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner-311"><a href="#Combiner-311"><span class="linenos">311</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner-312"><a href="#Combiner-312"><span class="linenos">312</span></a>                <span class="p">),</span>
</span><span id="Combiner-313"><a href="#Combiner-313"><span class="linenos">313</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner-314"><a href="#Combiner-314"><span class="linenos">314</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner-315"><a href="#Combiner-315"><span class="linenos">315</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner-316"><a href="#Combiner-316"><span class="linenos">316</span></a>                <span class="p">),</span>
</span><span id="Combiner-317"><a href="#Combiner-317"><span class="linenos">317</span></a>        <span class="p">}</span>
</span><span id="Combiner-318"><a href="#Combiner-318"><span class="linenos">318</span></a>
</span><span id="Combiner-319"><a href="#Combiner-319"><span class="linenos">319</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
</span><span id="Combiner-320"><a href="#Combiner-320"><span class="linenos">320</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner-321"><a href="#Combiner-321"><span class="linenos">321</span></a>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]:</span>
</span><span id="Combiner-322"><a href="#Combiner-322"><span class="linenos">322</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner-323"><a href="#Combiner-323"><span class="linenos">323</span></a>
</span><span id="Combiner-324"><a href="#Combiner-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">draw_grid_coords_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner-325"><a href="#Combiner-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws coordinate text onto a `MapImage` at every interval as defined for this `Combiner` instance.</span>
</span><span id="Combiner-326"><a href="#Combiner-326"><span class="linenos">326</span></a>
</span><span id="Combiner-327"><a href="#Combiner-327"><span class="linenos">327</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="Combiner-328"><a href="#Combiner-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner-329"><a href="#Combiner-329"><span class="linenos">329</span></a>        <span class="n">bbox_before_grid</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="Combiner-330"><a href="#Combiner-330"><span class="linenos">330</span></a>        <span class="k">assert</span> <span class="n">bbox_before_grid</span>
</span><span id="Combiner-331"><a href="#Combiner-331"><span class="linenos">331</span></a>
</span><span id="Combiner-332"><a href="#Combiner-332"><span class="linenos">332</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="Combiner-333"><a href="#Combiner-333"><span class="linenos">333</span></a>
</span><span id="Combiner-334"><a href="#Combiner-334"><span class="linenos">334</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Combiner-335"><a href="#Combiner-335"><span class="linenos">335</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner-336"><a href="#Combiner-336"><span class="linenos">336</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner-337"><a href="#Combiner-337"><span class="linenos">337</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner-338"><a href="#Combiner-338"><span class="linenos">338</span></a>                <span class="p">),</span>
</span><span id="Combiner-339"><a href="#Combiner-339"><span class="linenos">339</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner-340"><a href="#Combiner-340"><span class="linenos">340</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner-341"><a href="#Combiner-341"><span class="linenos">341</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner-342"><a href="#Combiner-342"><span class="linenos">342</span></a>                <span class="p">),</span>
</span><span id="Combiner-343"><a href="#Combiner-343"><span class="linenos">343</span></a>        <span class="p">}</span>
</span><span id="Combiner-344"><a href="#Combiner-344"><span class="linenos">344</span></a>
</span><span id="Combiner-345"><a href="#Combiner-345"><span class="linenos">345</span></a>        <span class="n">interval_coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MapImageCoord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">MapImageCoord</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]]</span>
</span><span id="Combiner-346"><a href="#Combiner-346"><span class="linenos">346</span></a>        <span class="n">total_intervals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">)</span>
</span><span id="Combiner-347"><a href="#Combiner-347"><span class="linenos">347</span></a>
</span><span id="Combiner-348"><a href="#Combiner-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span><span id="Combiner-349"><a href="#Combiner-349"><span class="linenos">349</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over; this may take some time.&#39;</span><span class="p">)</span>
</span><span id="Combiner-350"><a href="#Combiner-350"><span class="linenos">350</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over, which can take a very long time.&#39;</span> <span class="o">+</span>
</span><span id="Combiner-351"><a href="#Combiner-351"><span class="linenos">351</span></a>                <span class="s1">&#39; You can press Ctrl+C to cancel during this process if needed. Continue?&#39;</span><span class="p">):</span>
</span><span id="Combiner-352"><a href="#Combiner-352"><span class="linenos">352</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="Combiner-353"><a href="#Combiner-353"><span class="linenos">353</span></a>                <span class="k">return</span>
</span><span id="Combiner-354"><a href="#Combiner-354"><span class="linenos">354</span></a>        <span class="k">elif</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
</span><span id="Combiner-355"><a href="#Combiner-355"><span class="linenos">355</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;More than 5000 grid intervals will be iterated over;&#39;</span> <span class="o">+</span>
</span><span id="Combiner-356"><a href="#Combiner-356"><span class="linenos">356</span></a>                <span class="s1">&#39; the progress bar</span><span class="se">\&#39;</span><span class="s1">s description text will not update per iteration in order to save speed.&#39;</span><span class="p">)</span>
</span><span id="Combiner-357"><a href="#Combiner-357"><span class="linenos">357</span></a>
</span><span id="Combiner-358"><a href="#Combiner-358"><span class="linenos">358</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing coordinates...&#39;</span><span class="p">)</span>
</span><span id="Combiner-359"><a href="#Combiner-359"><span class="linenos">359</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner-360"><a href="#Combiner-360"><span class="linenos">360</span></a>        <span class="k">for</span> <span class="n">img_coord</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pbar</span> <span class="o">:=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">)):</span>
</span><span id="Combiner-361"><a href="#Combiner-361"><span class="linenos">361</span></a>            <span class="n">game_coord</span> <span class="o">=</span> <span class="n">img_coord</span><span class="o">.</span><span class="n">to_game_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner-362"><a href="#Combiner-362"><span class="linenos">362</span></a>            <span class="n">coord_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Combiner-363"><a href="#Combiner-363"><span class="linenos">363</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span> <span class="ow">and</span> <span class="p">(</span><span class="n">total_intervals</span> <span class="o">&lt;=</span> <span class="mi">5000</span><span class="p">):</span>
</span><span id="Combiner-364"><a href="#Combiner-364"><span class="linenos">364</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Drawing </span><span class="si">{</span><span class="n">coord_text</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner-365"><a href="#Combiner-365"><span class="linenos">365</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">coord_text</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_text_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner-366"><a href="#Combiner-366"><span class="linenos">366</span></a>
</span><span id="Combiner-367"><a href="#Combiner-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Combiner-368"><a href="#Combiner-368"><span class="linenos">368</span></a>            <span class="n">world</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="Combiner-369"><a href="#Combiner-369"><span class="linenos">369</span></a>            <span class="n">detail</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Combiner-370"><a href="#Combiner-370"><span class="linenos">370</span></a>            <span class="n">autotrim</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner-371"><a href="#Combiner-371"><span class="linenos">371</span></a>            <span class="n">area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Combiner-372"><a href="#Combiner-372"><span class="linenos">372</span></a>            <span class="n">force_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Combiner-373"><a href="#Combiner-373"><span class="linenos">373</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MapImage</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner-374"><a href="#Combiner-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine the given world (dimension) tile images into one large map.</span>
</span><span id="Combiner-375"><a href="#Combiner-375"><span class="linenos">375</span></a>
</span><span id="Combiner-376"><a href="#Combiner-376"><span class="linenos">376</span></a><span class="sd">        :param world: Name of the world to combine images of.\</span>
</span><span id="Combiner-377"><a href="#Combiner-377"><span class="linenos">377</span></a><span class="sd">            Should be the name of a subdirectory located in this instance&#39;s `tiles_dir`.</span>
</span><span id="Combiner-378"><a href="#Combiner-378"><span class="linenos">378</span></a><span class="sd">        :param detail: The level of detail, 0 up through 3, to use for this map.\</span>
</span><span id="Combiner-379"><a href="#Combiner-379"><span class="linenos">379</span></a><span class="sd">            Will correspond to which numbered subdirectory within the given world to use images from.</span>
</span><span id="Combiner-380"><a href="#Combiner-380"><span class="linenos">380</span></a><span class="sd">        :param area: Specifies an area of the world to export rather than rendering the full map.\</span>
</span><span id="Combiner-381"><a href="#Combiner-381"><span class="linenos">381</span></a><span class="sd">            Takes coordinates as they would appear in Minecraft. Using this will disable `autotrim` implicitly.</span>
</span><span id="Combiner-382"><a href="#Combiner-382"><span class="linenos">382</span></a><span class="sd">        :param force_size: Centers the final image in a new image of this size.\</span>
</span><span id="Combiner-383"><a href="#Combiner-383"><span class="linenos">383</span></a><span class="sd">            Using this will disable `autotrim` implicitly.</span>
</span><span id="Combiner-384"><a href="#Combiner-384"><span class="linenos">384</span></a>
</span><span id="Combiner-385"><a href="#Combiner-385"><span class="linenos">385</span></a><span class="sd">        :returns: Returns the created `MapImage` if successful, or `None` if the process failed or was cancelled at any point.</span>
</span><span id="Combiner-386"><a href="#Combiner-386"><span class="linenos">386</span></a><span class="sd">        :rtype: MapImage, None</span>
</span><span id="Combiner-387"><a href="#Combiner-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner-388"><a href="#Combiner-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">world</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span>
</span><span id="Combiner-389"><a href="#Combiner-389"><span class="linenos">389</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No world directory of name &quot;</span><span class="si">{</span><span class="n">world</span><span class="si">}</span><span class="s1">&quot; exists in &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</span><span id="Combiner-390"><a href="#Combiner-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">detail</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
</span><span id="Combiner-391"><a href="#Combiner-391"><span class="linenos">391</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detail level must be between 0 and 3; given </span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner-392"><a href="#Combiner-392"><span class="linenos">392</span></a>        <span class="n">source_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span> <span class="o">/</span> <span class="n">world</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">detail</span><span class="p">)</span>
</span><span id="Combiner-393"><a href="#Combiner-393"><span class="linenos">393</span></a>
</span><span id="Combiner-394"><a href="#Combiner-394"><span class="linenos">394</span></a>        <span class="n">detail_mul</span> <span class="o">=</span> <span class="n">DETAIL_SBPP</span><span class="p">[</span><span class="n">detail</span><span class="p">]</span>
</span><span id="Combiner-395"><a href="#Combiner-395"><span class="linenos">395</span></a>
</span><span id="Combiner-396"><a href="#Combiner-396"><span class="linenos">396</span></a>        <span class="c1"># Sort out what regions we&#39;re going to stitch</span>
</span><span id="Combiner-397"><a href="#Combiner-397"><span class="linenos">397</span></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Combiner-398"><a href="#Combiner-398"><span class="linenos">398</span></a>        <span class="n">rows</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Combiner-399"><a href="#Combiner-399"><span class="linenos">399</span></a>        <span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Combiner-400"><a href="#Combiner-400"><span class="linenos">400</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finding region images...&#39;</span><span class="p">)</span>
</span><span id="Combiner-401"><a href="#Combiner-401"><span class="linenos">401</span></a>        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">source_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*_*.png&#39;</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">):</span>
</span><span id="Combiner-402"><a href="#Combiner-402"><span class="linenos">402</span></a>            <span class="n">col</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
</span><span id="Combiner-403"><a href="#Combiner-403"><span class="linenos">403</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Combiner-404"><a href="#Combiner-404"><span class="linenos">404</span></a>                <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="Combiner-405"><a href="#Combiner-405"><span class="linenos">405</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Combiner-406"><a href="#Combiner-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
</span><span id="Combiner-407"><a href="#Combiner-407"><span class="linenos">407</span></a>                <span class="n">rows</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="Combiner-408"><a href="#Combiner-408"><span class="linenos">408</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
</span><span id="Combiner-409"><a href="#Combiner-409"><span class="linenos">409</span></a>
</span><span id="Combiner-410"><a href="#Combiner-410"><span class="linenos">410</span></a>        <span class="c1"># Deep-sort columns + rows</span>
</span><span id="Combiner-411"><a href="#Combiner-411"><span class="linenos">411</span></a>        <span class="n">regions</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:{</span><span class="n">v</span><span class="p">:</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span>
</span><span id="Combiner-412"><a href="#Combiner-412"><span class="linenos">412</span></a>        <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner-413"><a href="#Combiner-413"><span class="linenos">413</span></a>        <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner-414"><a href="#Combiner-414"><span class="linenos">414</span></a>
</span><span id="Combiner-415"><a href="#Combiner-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="Combiner-416"><a href="#Combiner-416"><span class="linenos">416</span></a>            <span class="n">area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="n">detail_mul</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">area</span><span class="p">])</span>
</span><span id="Combiner-417"><a href="#Combiner-417"><span class="linenos">417</span></a>            <span class="n">area_regions</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">snap_box</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)])</span>
</span><span id="Combiner-418"><a href="#Combiner-418"><span class="linenos">418</span></a>            <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner-419"><a href="#Combiner-419"><span class="linenos">419</span></a>            <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner-420"><a href="#Combiner-420"><span class="linenos">420</span></a>
</span><span id="Combiner-421"><a href="#Combiner-421"><span class="linenos">421</span></a>        <span class="n">size_estimate</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">)</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Combiner-422"><a href="#Combiner-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated image size: </span><span class="si">{</span><span class="n">size_estimate</span><span class="si">}</span><span class="se">\n</span><span class="s1">Continue?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span><span class="p">):</span>
</span><span id="Combiner-423"><a href="#Combiner-423"><span class="linenos">423</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="Combiner-424"><a href="#Combiner-424"><span class="linenos">424</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Combiner-425"><a href="#Combiner-425"><span class="linenos">425</span></a>
</span><span id="Combiner-426"><a href="#Combiner-426"><span class="linenos">426</span></a>        <span class="c1"># Start stitching</span>
</span><span id="Combiner-427"><a href="#Combiner-427"><span class="linenos">427</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
</span><span id="Combiner-428"><a href="#Combiner-428"><span class="linenos">428</span></a>            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span>
</span><span id="Combiner-429"><a href="#Combiner-429"><span class="linenos">429</span></a>            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="Combiner-430"><a href="#Combiner-430"><span class="linenos">430</span></a>        <span class="p">)</span>
</span><span id="Combiner-431"><a href="#Combiner-431"><span class="linenos">431</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Constructing image...&#39;</span><span class="p">)</span>
</span><span id="Combiner-432"><a href="#Combiner-432"><span class="linenos">432</span></a>
</span><span id="Combiner-433"><a href="#Combiner-433"><span class="linenos">433</span></a>        <span class="n">ta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Combiner-434"><a href="#Combiner-434"><span class="linenos">434</span></a>        <span class="c1"># Represents where 0, 0 in our Minecraft world is, in relation to the image&#39;s coordinates</span>
</span><span id="Combiner-435"><a href="#Combiner-435"><span class="linenos">435</span></a>        <span class="n">game_zero_in_image</span><span class="p">:</span> <span class="n">Coord2i</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Combiner-436"><a href="#Combiner-436"><span class="linenos">436</span></a>        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tqdm_product</span><span class="p">(</span><span class="n">column_range</span><span class="p">,</span> <span class="n">row_range</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Columns&#39;</span><span class="p">):</span>
</span><span id="Combiner-437"><a href="#Combiner-437"><span class="linenos">437</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">]):</span>
</span><span id="Combiner-438"><a href="#Combiner-438"><span class="linenos">438</span></a>                <span class="k">continue</span>
</span><span id="Combiner-439"><a href="#Combiner-439"><span class="linenos">439</span></a>            <span class="c1"># The pasting coordinates are determined based on what current column and row the for loops</span>
</span><span id="Combiner-440"><a href="#Combiner-440"><span class="linenos">440</span></a>            <span class="c1"># are on, so they&#39;ll increase by a tile regardless of whether an image has actually been pasted</span>
</span><span id="Combiner-441"><a href="#Combiner-441"><span class="linenos">441</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">column_range</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="Combiner-442"><a href="#Combiner-442"><span class="linenos">442</span></a>            <span class="n">tile_path</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
</span><span id="Combiner-443"><a href="#Combiner-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">:</span>
</span><span id="Combiner-444"><a href="#Combiner-444"><span class="linenos">444</span></a>                <span class="n">tqdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pasting image: </span><span class="si">{</span><span class="n">tile_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner-445"><a href="#Combiner-445"><span class="linenos">445</span></a>            <span class="n">paste_area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">])</span>
</span><span id="Combiner-446"><a href="#Combiner-446"><span class="linenos">446</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_zero_in_image</span><span class="p">:</span>
</span><span id="Combiner-447"><a href="#Combiner-447"><span class="linenos">447</span></a>                <span class="n">game_zero_in_image</span> <span class="o">=</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">Coord2i</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="Combiner-448"><a href="#Combiner-448"><span class="linenos">448</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">paste</span><span class="p">((</span><span class="n">tile_img</span> <span class="o">:=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tile_path</span><span class="p">)),</span> <span class="n">paste_area</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">tile_img</span><span class="p">)</span>
</span><span id="Combiner-449"><a href="#Combiner-449"><span class="linenos">449</span></a>
</span><span id="Combiner-450"><a href="#Combiner-450"><span class="linenos">450</span></a>        <span class="k">assert</span> <span class="n">game_zero_in_image</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">GAME_ZERO_IS_NONE</span>
</span><span id="Combiner-451"><a href="#Combiner-451"><span class="linenos">451</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="n">game_zero_in_image</span><span class="p">),</span> <span class="n">detail_mul</span><span class="p">)</span>
</span><span id="Combiner-452"><a href="#Combiner-452"><span class="linenos">452</span></a>        <span class="k">del</span> <span class="n">game_zero_in_image</span>
</span><span id="Combiner-453"><a href="#Combiner-453"><span class="linenos">453</span></a>
</span><span id="Combiner-454"><a href="#Combiner-454"><span class="linenos">454</span></a>        <span class="c1"># Crop if an area is specified</span>
</span><span id="Combiner-455"><a href="#Combiner-455"><span class="linenos">455</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="Combiner-456"><a href="#Combiner-456"><span class="linenos">456</span></a>            <span class="n">crop_area</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Combiner-457"><a href="#Combiner-457"><span class="linenos">457</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span>
</span><span id="Combiner-458"><a href="#Combiner-458"><span class="linenos">458</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
</span><span id="Combiner-459"><a href="#Combiner-459"><span class="linenos">459</span></a>            <span class="p">)</span>
</span><span id="Combiner-460"><a href="#Combiner-460"><span class="linenos">460</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">crop_area</span><span class="p">)</span>
</span><span id="Combiner-461"><a href="#Combiner-461"><span class="linenos">461</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Combiner-462"><a href="#Combiner-462"><span class="linenos">462</span></a>
</span><span id="Combiner-463"><a href="#Combiner-463"><span class="linenos">463</span></a>        <span class="c1"># Crop and resize if given an explicit size</span>
</span><span id="Combiner-464"><a href="#Combiner-464"><span class="linenos">464</span></a>        <span class="k">if</span> <span class="n">force_size</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">force_size</span><span class="p">):</span>
</span><span id="Combiner-465"><a href="#Combiner-465"><span class="linenos">465</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Resizing to </span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="Combiner-466"><a href="#Combiner-466"><span class="linenos">466</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">force_size</span><span class="p">)</span>
</span><span id="Combiner-467"><a href="#Combiner-467"><span class="linenos">467</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Combiner-468"><a href="#Combiner-468"><span class="linenos">468</span></a>
</span><span id="Combiner-469"><a href="#Combiner-469"><span class="linenos">469</span></a>        <span class="c1"># Things like grid lines and coordinate text are likely to end up drawn outside of the image&#39;s original bounding box,</span>
</span><span id="Combiner-470"><a href="#Combiner-470"><span class="linenos">470</span></a>        <span class="c1"># alterting what getbbox() would return. Get this bounding box *first*, and then use it to autotrim later.</span>
</span><span id="Combiner-471"><a href="#Combiner-471"><span class="linenos">471</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="Combiner-472"><a href="#Combiner-472"><span class="linenos">472</span></a>        <span class="k">assert</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">BBOX_IS_NONE</span>
</span><span id="Combiner-473"><a href="#Combiner-473"><span class="linenos">473</span></a>
</span><span id="Combiner-474"><a href="#Combiner-474"><span class="linenos">474</span></a>        <span class="c1"># Add grid and/or coordinates</span>
</span><span id="Combiner-475"><a href="#Combiner-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="Combiner-476"><a href="#Combiner-476"><span class="linenos">476</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">:</span>
</span><span id="Combiner-477"><a href="#Combiner-477"><span class="linenos">477</span></a>                <span class="k">raise</span> <span class="n">CombineError</span><span class="p">(</span><span class="s1">&#39;A grid interval must be set for this Combiner instance to add grid lines or grid coordinates&#39;</span><span class="p">)</span>
</span><span id="Combiner-478"><a href="#Combiner-478"><span class="linenos">478</span></a>
</span><span id="Combiner-479"><a href="#Combiner-479"><span class="linenos">479</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="Combiner-480"><a href="#Combiner-480"><span class="linenos">480</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_coords_text</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner-481"><a href="#Combiner-481"><span class="linenos">481</span></a>
</span><span id="Combiner-482"><a href="#Combiner-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span><span class="p">:</span>
</span><span id="Combiner-483"><a href="#Combiner-483"><span class="linenos">483</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing grid lines...&#39;</span><span class="p">)</span>
</span><span id="Combiner-484"><a href="#Combiner-484"><span class="linenos">484</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_lines</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner-485"><a href="#Combiner-485"><span class="linenos">485</span></a>
</span><span id="Combiner-486"><a href="#Combiner-486"><span class="linenos">486</span></a>        <span class="c1"># Trim transparent excess space</span>
</span><span id="Combiner-487"><a href="#Combiner-487"><span class="linenos">487</span></a>        <span class="k">if</span> <span class="n">autotrim</span><span class="p">:</span>
</span><span id="Combiner-488"><a href="#Combiner-488"><span class="linenos">488</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Trimming out blank space... (</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Combiner-489"><a href="#Combiner-489"><span class="linenos">489</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="Combiner-490"><a href="#Combiner-490"><span class="linenos">490</span></a>
</span><span id="Combiner-491"><a href="#Combiner-491"><span class="linenos">491</span></a>        <span class="c1"># Apply desired background color, if any</span>
</span><span id="Combiner-492"><a href="#Combiner-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Combiner-493"><a href="#Combiner-493"><span class="linenos">493</span></a>            <span class="n">image_bg</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner-494"><a href="#Combiner-494"><span class="linenos">494</span></a>            <span class="n">image_bg</span><span class="o">.</span><span class="n">alpha_composite</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner-495"><a href="#Combiner-495"><span class="linenos">495</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image_bg</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="Combiner-496"><a href="#Combiner-496"><span class="linenos">496</span></a>
</span><span id="Combiner-497"><a href="#Combiner-497"><span class="linenos">497</span></a>        <span class="c1"># Done.</span>
</span><span id="Combiner-498"><a href="#Combiner-498"><span class="linenos">498</span></a>        <span class="n">tb</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Combiner-499"><a href="#Combiner-499"><span class="linenos">499</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Image creation finished in </span><span class="si">{</span><span class="n">tb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ta</span><span class="si">:</span><span class="s1">04f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
</span><span id="Combiner-500"><a href="#Combiner-500"><span class="linenos">500</span></a>
</span><span id="Combiner-501"><a href="#Combiner-501"><span class="linenos">501</span></a>        <span class="k">return</span> <span class="n">image</span>
</span></pre></div>


            <div class="docstring"><p>Takes a squaremap <code>tiles</code> directory path, handles calculating rows/columns,
and is able to export full map images.</p>
</div>


                            <div id="Combiner.__init__" class="classattr">
                                        <input id="Combiner.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Combiner</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">tiles_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">use_tqdm</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">skip_confirmation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">grid_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">grid_coords_format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;(</span><span class="si">{x}</span><span class="s1">, </span><span class="si">{y}</span><span class="s1">)&#39;</span>,</span><span class="param">	<span class="n">style</span><span class="p">:</span> <span class="n"><a href="#CombinerStyle">CombinerStyle</a></span> <span class="o">=</span> <span class="n">CombinerStyle</span><span class="p">(</span><span class="n">background_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">grid_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span> <span class="n">show_grid_lines</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid_line_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span> <span class="n">show_grid_text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid_text_font</span><span class="o">=</span><span class="s1">&#39;arial&#39;</span><span class="p">,</span> <span class="n">grid_text_color</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="n">red</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">green</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">blue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">255</span><span class="p">),</span> <span class="n">grid_text_size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span></span>)</span>

                <label class="view-source-button" for="Combiner.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Combiner.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Combiner.__init__-250"><a href="#Combiner.__init__-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Combiner.__init__-251"><a href="#Combiner.__init__-251"><span class="linenos">251</span></a>            <span class="n">tiles_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="Combiner.__init__-252"><a href="#Combiner.__init__-252"><span class="linenos">252</span></a>            <span class="n">use_tqdm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner.__init__-253"><a href="#Combiner.__init__-253"><span class="linenos">253</span></a>            <span class="n">skip_confirmation</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner.__init__-254"><a href="#Combiner.__init__-254"><span class="linenos">254</span></a>            <span class="n">grid_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Combiner.__init__-255"><a href="#Combiner.__init__-255"><span class="linenos">255</span></a>            <span class="n">grid_coords_format</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="n">DEFAULT_COORDS_FORMAT</span><span class="p">,</span>
</span><span id="Combiner.__init__-256"><a href="#Combiner.__init__-256"><span class="linenos">256</span></a>            <span class="n">style</span><span class="p">:</span> <span class="n">CombinerStyle</span><span class="o">=</span><span class="n">DEFAULT_COMBINER_STYLE</span>
</span><span id="Combiner.__init__-257"><a href="#Combiner.__init__-257"><span class="linenos">257</span></a>        <span class="p">):</span>
</span><span id="Combiner.__init__-258"><a href="#Combiner.__init__-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Combiner.__init__-259"><a href="#Combiner.__init__-259"><span class="linenos">259</span></a><span class="sd">        :param tiles_dir: A path to a directory in the same format as what squaremap automatically generates.</span>
</span><span id="Combiner.__init__-260"><a href="#Combiner.__init__-260"><span class="linenos">260</span></a><span class="sd">            Example:</span>
</span><span id="Combiner.__init__-261"><a href="#Combiner.__init__-261"><span class="linenos">261</span></a>
</span><span id="Combiner.__init__-262"><a href="#Combiner.__init__-262"><span class="linenos">262</span></a><span class="sd">        .. code-block:: text</span>
</span><span id="Combiner.__init__-263"><a href="#Combiner.__init__-263"><span class="linenos">263</span></a><span class="sd">            tiles (&lt;- what this path should point to)</span>
</span><span id="Combiner.__init__-264"><a href="#Combiner.__init__-264"><span class="linenos">264</span></a><span class="sd">            minecraft_overworld</span>
</span><span id="Combiner.__init__-265"><a href="#Combiner.__init__-265"><span class="linenos">265</span></a><span class="sd">            |   0</span>
</span><span id="Combiner.__init__-266"><a href="#Combiner.__init__-266"><span class="linenos">266</span></a><span class="sd">            |   1</span>
</span><span id="Combiner.__init__-267"><a href="#Combiner.__init__-267"><span class="linenos">267</span></a><span class="sd">            |   2</span>
</span><span id="Combiner.__init__-268"><a href="#Combiner.__init__-268"><span class="linenos">268</span></a><span class="sd">            |   3</span>
</span><span id="Combiner.__init__-269"><a href="#Combiner.__init__-269"><span class="linenos">269</span></a><span class="sd">            minecraft_the_nether</span>
</span><span id="Combiner.__init__-270"><a href="#Combiner.__init__-270"><span class="linenos">270</span></a><span class="sd">            |   0</span>
</span><span id="Combiner.__init__-271"><a href="#Combiner.__init__-271"><span class="linenos">271</span></a><span class="sd">            |   1</span>
</span><span id="Combiner.__init__-272"><a href="#Combiner.__init__-272"><span class="linenos">272</span></a><span class="sd">            |   2</span>
</span><span id="Combiner.__init__-273"><a href="#Combiner.__init__-273"><span class="linenos">273</span></a><span class="sd">            |   3</span>
</span><span id="Combiner.__init__-274"><a href="#Combiner.__init__-274"><span class="linenos">274</span></a><span class="sd">            minecraft_the_end</span>
</span><span id="Combiner.__init__-275"><a href="#Combiner.__init__-275"><span class="linenos">275</span></a><span class="sd">                0</span>
</span><span id="Combiner.__init__-276"><a href="#Combiner.__init__-276"><span class="linenos">276</span></a><span class="sd">                1</span>
</span><span id="Combiner.__init__-277"><a href="#Combiner.__init__-277"><span class="linenos">277</span></a><span class="sd">                2</span>
</span><span id="Combiner.__init__-278"><a href="#Combiner.__init__-278"><span class="linenos">278</span></a><span class="sd">                3</span>
</span><span id="Combiner.__init__-279"><a href="#Combiner.__init__-279"><span class="linenos">279</span></a>
</span><span id="Combiner.__init__-280"><a href="#Combiner.__init__-280"><span class="linenos">280</span></a><span class="sd">        :param use_tqdm: Whether to show a `tqdm` progress bar for any functions that support it.</span>
</span><span id="Combiner.__init__-281"><a href="#Combiner.__init__-281"><span class="linenos">281</span></a><span class="sd">        :param skip_confirmation: Whether to skip any confirmation prompts. Setting to `True` allows any function</span>
</span><span id="Combiner.__init__-282"><a href="#Combiner.__init__-282"><span class="linenos">282</span></a><span class="sd">            in this class to run unattended to.</span>
</span><span id="Combiner.__init__-283"><a href="#Combiner.__init__-283"><span class="linenos">283</span></a><span class="sd">        :param grid_interval: An X and Y interval that should be used for things like drawing grid lines or coordinates onto \</span>
</span><span id="Combiner.__init__-284"><a href="#Combiner.__init__-284"><span class="linenos">284</span></a><span class="sd">            the finished image.</span>
</span><span id="Combiner.__init__-285"><a href="#Combiner.__init__-285"><span class="linenos">285</span></a><span class="sd">        :param grid_coords_format: A format string to be used when drawing grid coordinates. \</span>
</span><span id="Combiner.__init__-286"><a href="#Combiner.__init__-286"><span class="linenos">286</span></a><span class="sd">            Valid formatting options are `{x}` and {y}`.</span>
</span><span id="Combiner.__init__-287"><a href="#Combiner.__init__-287"><span class="linenos">287</span></a><span class="sd">        :param style: `CombinerStyle` instance to define styling rules with.</span>
</span><span id="Combiner.__init__-288"><a href="#Combiner.__init__-288"><span class="linenos">288</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner.__init__-289"><a href="#Combiner.__init__-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">tiles_dir</span> <span class="o">:=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tiles_dir</span><span class="p">))</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
</span><span id="Combiner.__init__-290"><a href="#Combiner.__init__-290"><span class="linenos">290</span></a>            <span class="k">raise</span> <span class="ne">NotADirectoryError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Not a directory: </span><span class="si">{</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner.__init__-291"><a href="#Combiner.__init__-291"><span class="linenos">291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span>          <span class="o">=</span> <span class="n">tiles_dir</span>
</span><span id="Combiner.__init__-292"><a href="#Combiner.__init__-292"><span class="linenos">292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span>           <span class="o">=</span> <span class="n">use_tqdm</span>
</span><span id="Combiner.__init__-293"><a href="#Combiner.__init__-293"><span class="linenos">293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span>  <span class="o">=</span> <span class="n">skip_confirmation</span>
</span><span id="Combiner.__init__-294"><a href="#Combiner.__init__-294"><span class="linenos">294</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span>      <span class="o">=</span> <span class="n">grid_interval</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="Combiner.__init__-295"><a href="#Combiner.__init__-295"><span class="linenos">295</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span> <span class="o">=</span> <span class="n">grid_coords_format</span>
</span><span id="Combiner.__init__-296"><a href="#Combiner.__init__-296"><span class="linenos">296</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">style</span>              <span class="o">=</span> <span class="n">style</span>
</span><span id="Combiner.__init__-297"><a href="#Combiner.__init__-297"><span class="linenos">297</span></a>
</span><span id="Combiner.__init__-298"><a href="#Combiner.__init__-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">tiles_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;minecraft_*/&#39;</span><span class="p">)]</span>
</span><span id="Combiner.__init__-299"><a href="#Combiner.__init__-299"><span class="linenos">299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;What valid world folders the given `tiles_dir` contains.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>tiles_dir</strong>:  A path to a directory in the same format as what squaremap automatically generates.
Example:</li>
</ul>

<div class="pdoc-code codehilite">
<pre><span></span><code>tiles (&lt;- what this path should point to)
minecraft_overworld
|   0
|   1
|   2
|   3
minecraft_the_nether
|   0
|   1
|   2
|   3
minecraft_the_end
    0
    1
    2
    3
</code></pre>
</div>

<ul>
<li><strong>use_tqdm</strong>:  Whether to show a <code>tqdm</code> progress bar for any functions that support it.</li>
<li><strong>skip_confirmation</strong>:  Whether to skip any confirmation prompts. Setting to <code>True</code> allows any function
in this class to run unattended to.</li>
<li><strong>grid_interval</strong>:  An X and Y interval that should be used for things like drawing grid lines or coordinates onto             the finished image.</li>
<li><strong>grid_coords_format</strong>:  A format string to be used when drawing grid coordinates.             Valid formatting options are <code>{x}</code> and {y}`.</li>
<li><strong>style</strong>:  <code><a href="#CombinerStyle">CombinerStyle</a></code> instance to define styling rules with.</li>
</ul>
</div>


                            </div>
                            <div id="Combiner.TILE_SIZE" class="classattr">
                                <div class="attr variable">
            <span class="name">TILE_SIZE</span><span class="annotation">: int</span>        =
<span class="default_value">512</span>

        
    </div>
    <a class="headerlink" href="#Combiner.TILE_SIZE"></a>
    
            <div class="docstring"><p>The size of each tile image in pixels.
Only made a constant in case squaremap happens to change its image sizes in the future.</p>
</div>


                            </div>
                            <div id="Combiner.STANDARD_WORLDS" class="classattr">
                                <div class="attr variable">
            <span class="name">STANDARD_WORLDS</span><span class="annotation">: list[str]</span>        =
<span class="default_value">[&#39;overworld&#39;, &#39;the_nether&#39;, &#39;the_end&#39;]</span>

        
    </div>
    <a class="headerlink" href="#Combiner.STANDARD_WORLDS"></a>
    
    

                            </div>
                            <div id="Combiner.tiles_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">tiles_dir</span>

        
    </div>
    <a class="headerlink" href="#Combiner.tiles_dir"></a>
    
    

                            </div>
                            <div id="Combiner.use_tqdm" class="classattr">
                                <div class="attr variable">
            <span class="name">use_tqdm</span>

        
    </div>
    <a class="headerlink" href="#Combiner.use_tqdm"></a>
    
    

                            </div>
                            <div id="Combiner.skip_confirmation" class="classattr">
                                <div class="attr variable">
            <span class="name">skip_confirmation</span>

        
    </div>
    <a class="headerlink" href="#Combiner.skip_confirmation"></a>
    
    

                            </div>
                            <div id="Combiner.grid_interval" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_interval</span>

        
    </div>
    <a class="headerlink" href="#Combiner.grid_interval"></a>
    
    

                            </div>
                            <div id="Combiner.grid_coords_format" class="classattr">
                                <div class="attr variable">
            <span class="name">grid_coords_format</span>

        
    </div>
    <a class="headerlink" href="#Combiner.grid_coords_format"></a>
    
    

                            </div>
                            <div id="Combiner.style" class="classattr">
                                <div class="attr variable">
            <span class="name">style</span>

        
    </div>
    <a class="headerlink" href="#Combiner.style"></a>
    
    

                            </div>
                            <div id="Combiner.mapped_worlds" class="classattr">
                                <div class="attr variable">
            <span class="name">mapped_worlds</span><span class="annotation">: list[str]</span>

        
    </div>
    <a class="headerlink" href="#Combiner.mapped_worlds"></a>
    
            <div class="docstring"><p>What valid world folders the given <code><a href="#Combiner.tiles_dir">tiles_dir</a></code> contains.</p>
</div>


                            </div>
                            <div id="Combiner.draw_grid_lines" class="classattr">
                                        <input id="Combiner.draw_grid_lines-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_grid_lines</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span><span class="p">:</span> <span class="n"><a href="#MapImage">MapImage</a></span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Combiner.draw_grid_lines-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Combiner.draw_grid_lines"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Combiner.draw_grid_lines-301"><a href="#Combiner.draw_grid_lines-301"><span class="linenos">301</span></a>    <span class="k">def</span> <span class="nf">draw_grid_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner.draw_grid_lines-302"><a href="#Combiner.draw_grid_lines-302"><span class="linenos">302</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws grid lines onto a `MapImage` at the intervals defined for this `Combiner` instance.</span>
</span><span id="Combiner.draw_grid_lines-303"><a href="#Combiner.draw_grid_lines-303"><span class="linenos">303</span></a>
</span><span id="Combiner.draw_grid_lines-304"><a href="#Combiner.draw_grid_lines-304"><span class="linenos">304</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="Combiner.draw_grid_lines-305"><a href="#Combiner.draw_grid_lines-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner.draw_grid_lines-306"><a href="#Combiner.draw_grid_lines-306"><span class="linenos">306</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_lines-307"><a href="#Combiner.draw_grid_lines-307"><span class="linenos">307</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="Combiner.draw_grid_lines-308"><a href="#Combiner.draw_grid_lines-308"><span class="linenos">308</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Combiner.draw_grid_lines-309"><a href="#Combiner.draw_grid_lines-309"><span class="linenos">309</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner.draw_grid_lines-310"><a href="#Combiner.draw_grid_lines-310"><span class="linenos">310</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_lines-311"><a href="#Combiner.draw_grid_lines-311"><span class="linenos">311</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner.draw_grid_lines-312"><a href="#Combiner.draw_grid_lines-312"><span class="linenos">312</span></a>                <span class="p">),</span>
</span><span id="Combiner.draw_grid_lines-313"><a href="#Combiner.draw_grid_lines-313"><span class="linenos">313</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner.draw_grid_lines-314"><a href="#Combiner.draw_grid_lines-314"><span class="linenos">314</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_lines-315"><a href="#Combiner.draw_grid_lines-315"><span class="linenos">315</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner.draw_grid_lines-316"><a href="#Combiner.draw_grid_lines-316"><span class="linenos">316</span></a>                <span class="p">),</span>
</span><span id="Combiner.draw_grid_lines-317"><a href="#Combiner.draw_grid_lines-317"><span class="linenos">317</span></a>        <span class="p">}</span>
</span><span id="Combiner.draw_grid_lines-318"><a href="#Combiner.draw_grid_lines-318"><span class="linenos">318</span></a>
</span><span id="Combiner.draw_grid_lines-319"><a href="#Combiner.draw_grid_lines-319"><span class="linenos">319</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]:</span>
</span><span id="Combiner.draw_grid_lines-320"><a href="#Combiner.draw_grid_lines-320"><span class="linenos">320</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner.draw_grid_lines-321"><a href="#Combiner.draw_grid_lines-321"><span class="linenos">321</span></a>        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]:</span>
</span><span id="Combiner.draw_grid_lines-322"><a href="#Combiner.draw_grid_lines-322"><span class="linenos">322</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">line</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_line_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Draws grid lines onto a <code><a href="#MapImage">MapImage</a></code> at the intervals defined for this <code><a href="#Combiner">Combiner</a></code> instance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>image</strong>:  The <code><a href="#MapImage">MapImage</a></code> to draw coordinates onto. Its <code>game_zero</code> attribute is used as the origin point.</li>
</ul>
</div>


                            </div>
                            <div id="Combiner.draw_grid_coords_text" class="classattr">
                                        <input id="Combiner.draw_grid_coords_text-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">draw_grid_coords_text</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">image</span><span class="p">:</span> <span class="n"><a href="#MapImage">MapImage</a></span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Combiner.draw_grid_coords_text-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Combiner.draw_grid_coords_text"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Combiner.draw_grid_coords_text-324"><a href="#Combiner.draw_grid_coords_text-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">draw_grid_coords_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">MapImage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner.draw_grid_coords_text-325"><a href="#Combiner.draw_grid_coords_text-325"><span class="linenos">325</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws coordinate text onto a `MapImage` at every interval as defined for this `Combiner` instance.</span>
</span><span id="Combiner.draw_grid_coords_text-326"><a href="#Combiner.draw_grid_coords_text-326"><span class="linenos">326</span></a>
</span><span id="Combiner.draw_grid_coords_text-327"><a href="#Combiner.draw_grid_coords_text-327"><span class="linenos">327</span></a><span class="sd">        :param image: The `MapImage` to draw coordinates onto. Its `game_zero` attribute is used as the origin point.</span>
</span><span id="Combiner.draw_grid_coords_text-328"><a href="#Combiner.draw_grid_coords_text-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner.draw_grid_coords_text-329"><a href="#Combiner.draw_grid_coords_text-329"><span class="linenos">329</span></a>        <span class="n">bbox_before_grid</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="Combiner.draw_grid_coords_text-330"><a href="#Combiner.draw_grid_coords_text-330"><span class="linenos">330</span></a>        <span class="k">assert</span> <span class="n">bbox_before_grid</span>
</span><span id="Combiner.draw_grid_coords_text-331"><a href="#Combiner.draw_grid_coords_text-331"><span class="linenos">331</span></a>
</span><span id="Combiner.draw_grid_coords_text-332"><a href="#Combiner.draw_grid_coords_text-332"><span class="linenos">332</span></a>        <span class="n">grid_origin</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span>
</span><span id="Combiner.draw_grid_coords_text-333"><a href="#Combiner.draw_grid_coords_text-333"><span class="linenos">333</span></a>
</span><span id="Combiner.draw_grid_coords_text-334"><a href="#Combiner.draw_grid_coords_text-334"><span class="linenos">334</span></a>        <span class="n">coord_axes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Combiner.draw_grid_coords_text-335"><a href="#Combiner.draw_grid_coords_text-335"><span class="linenos">335</span></a>            <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner.draw_grid_coords_text-336"><a href="#Combiner.draw_grid_coords_text-336"><span class="linenos">336</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_coords_text-337"><a href="#Combiner.draw_grid_coords_text-337"><span class="linenos">337</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner.draw_grid_coords_text-338"><a href="#Combiner.draw_grid_coords_text-338"><span class="linenos">338</span></a>                <span class="p">),</span>
</span><span id="Combiner.draw_grid_coords_text-339"><a href="#Combiner.draw_grid_coords_text-339"><span class="linenos">339</span></a>            <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span>
</span><span id="Combiner.draw_grid_coords_text-340"><a href="#Combiner.draw_grid_coords_text-340"><span class="linenos">340</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_coords_text-341"><a href="#Combiner.draw_grid_coords_text-341"><span class="linenos">341</span></a>                <span class="p">[</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">grid_origin</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)]</span>
</span><span id="Combiner.draw_grid_coords_text-342"><a href="#Combiner.draw_grid_coords_text-342"><span class="linenos">342</span></a>                <span class="p">),</span>
</span><span id="Combiner.draw_grid_coords_text-343"><a href="#Combiner.draw_grid_coords_text-343"><span class="linenos">343</span></a>        <span class="p">}</span>
</span><span id="Combiner.draw_grid_coords_text-344"><a href="#Combiner.draw_grid_coords_text-344"><span class="linenos">344</span></a>
</span><span id="Combiner.draw_grid_coords_text-345"><a href="#Combiner.draw_grid_coords_text-345"><span class="linenos">345</span></a>        <span class="n">interval_coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MapImageCoord</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">MapImageCoord</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">coord_axes</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]]</span>
</span><span id="Combiner.draw_grid_coords_text-346"><a href="#Combiner.draw_grid_coords_text-346"><span class="linenos">346</span></a>        <span class="n">total_intervals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-347"><a href="#Combiner.draw_grid_coords_text-347"><span class="linenos">347</span></a>
</span><span id="Combiner.draw_grid_coords_text-348"><a href="#Combiner.draw_grid_coords_text-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>
</span><span id="Combiner.draw_grid_coords_text-349"><a href="#Combiner.draw_grid_coords_text-349"><span class="linenos">349</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over; this may take some time.&#39;</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-350"><a href="#Combiner.draw_grid_coords_text-350"><span class="linenos">350</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="s1">&#39;More than 50,000 grid intervals will be iterated over, which can take a very long time.&#39;</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_coords_text-351"><a href="#Combiner.draw_grid_coords_text-351"><span class="linenos">351</span></a>                <span class="s1">&#39; You can press Ctrl+C to cancel during this process if needed. Continue?&#39;</span><span class="p">):</span>
</span><span id="Combiner.draw_grid_coords_text-352"><a href="#Combiner.draw_grid_coords_text-352"><span class="linenos">352</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-353"><a href="#Combiner.draw_grid_coords_text-353"><span class="linenos">353</span></a>                <span class="k">return</span>
</span><span id="Combiner.draw_grid_coords_text-354"><a href="#Combiner.draw_grid_coords_text-354"><span class="linenos">354</span></a>        <span class="k">elif</span> <span class="n">total_intervals</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
</span><span id="Combiner.draw_grid_coords_text-355"><a href="#Combiner.draw_grid_coords_text-355"><span class="linenos">355</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;More than 5000 grid intervals will be iterated over;&#39;</span> <span class="o">+</span>
</span><span id="Combiner.draw_grid_coords_text-356"><a href="#Combiner.draw_grid_coords_text-356"><span class="linenos">356</span></a>                <span class="s1">&#39; the progress bar</span><span class="se">\&#39;</span><span class="s1">s description text will not update per iteration in order to save speed.&#39;</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-357"><a href="#Combiner.draw_grid_coords_text-357"><span class="linenos">357</span></a>
</span><span id="Combiner.draw_grid_coords_text-358"><a href="#Combiner.draw_grid_coords_text-358"><span class="linenos">358</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing coordinates...&#39;</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-359"><a href="#Combiner.draw_grid_coords_text-359"><span class="linenos">359</span></a>        <span class="n">idraw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-360"><a href="#Combiner.draw_grid_coords_text-360"><span class="linenos">360</span></a>        <span class="k">for</span> <span class="n">img_coord</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pbar</span> <span class="o">:=</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">interval_coords</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">)):</span>
</span><span id="Combiner.draw_grid_coords_text-361"><a href="#Combiner.draw_grid_coords_text-361"><span class="linenos">361</span></a>            <span class="n">game_coord</span> <span class="o">=</span> <span class="n">img_coord</span><span class="o">.</span><span class="n">to_game_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-362"><a href="#Combiner.draw_grid_coords_text-362"><span class="linenos">362</span></a>            <span class="n">coord_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_coords_format</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">game_coord</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-363"><a href="#Combiner.draw_grid_coords_text-363"><span class="linenos">363</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span> <span class="ow">and</span> <span class="p">(</span><span class="n">total_intervals</span> <span class="o">&lt;=</span> <span class="mi">5000</span><span class="p">):</span>
</span><span id="Combiner.draw_grid_coords_text-364"><a href="#Combiner.draw_grid_coords_text-364"><span class="linenos">364</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Drawing </span><span class="si">{</span><span class="n">coord_text</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner.draw_grid_coords_text-365"><a href="#Combiner.draw_grid_coords_text-365"><span class="linenos">365</span></a>            <span class="n">idraw</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">img_coord</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span> <span class="n">text</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">coord_text</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">grid_text_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Draws coordinate text onto a <code><a href="#MapImage">MapImage</a></code> at every interval as defined for this <code><a href="#Combiner">Combiner</a></code> instance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>image</strong>:  The <code><a href="#MapImage">MapImage</a></code> to draw coordinates onto. Its <code>game_zero</code> attribute is used as the origin point.</li>
</ul>
</div>


                            </div>
                            <div id="Combiner.combine" class="classattr">
                                        <input id="Combiner.combine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">combine</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">world</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">detail</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">autotrim</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">force_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#MapImage">MapImage</a></span> <span class="o">|</span> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="Combiner.combine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Combiner.combine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Combiner.combine-367"><a href="#Combiner.combine-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
</span><span id="Combiner.combine-368"><a href="#Combiner.combine-368"><span class="linenos">368</span></a>            <span class="n">world</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="Combiner.combine-369"><a href="#Combiner.combine-369"><span class="linenos">369</span></a>            <span class="n">detail</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="Combiner.combine-370"><a href="#Combiner.combine-370"><span class="linenos">370</span></a>            <span class="n">autotrim</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Combiner.combine-371"><a href="#Combiner.combine-371"><span class="linenos">371</span></a>            <span class="n">area</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Rectangle</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="Combiner.combine-372"><a href="#Combiner.combine-372"><span class="linenos">372</span></a>            <span class="n">force_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span>
</span><span id="Combiner.combine-373"><a href="#Combiner.combine-373"><span class="linenos">373</span></a>        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MapImage</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Combiner.combine-374"><a href="#Combiner.combine-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Combine the given world (dimension) tile images into one large map.</span>
</span><span id="Combiner.combine-375"><a href="#Combiner.combine-375"><span class="linenos">375</span></a>
</span><span id="Combiner.combine-376"><a href="#Combiner.combine-376"><span class="linenos">376</span></a><span class="sd">        :param world: Name of the world to combine images of.\</span>
</span><span id="Combiner.combine-377"><a href="#Combiner.combine-377"><span class="linenos">377</span></a><span class="sd">            Should be the name of a subdirectory located in this instance&#39;s `tiles_dir`.</span>
</span><span id="Combiner.combine-378"><a href="#Combiner.combine-378"><span class="linenos">378</span></a><span class="sd">        :param detail: The level of detail, 0 up through 3, to use for this map.\</span>
</span><span id="Combiner.combine-379"><a href="#Combiner.combine-379"><span class="linenos">379</span></a><span class="sd">            Will correspond to which numbered subdirectory within the given world to use images from.</span>
</span><span id="Combiner.combine-380"><a href="#Combiner.combine-380"><span class="linenos">380</span></a><span class="sd">        :param area: Specifies an area of the world to export rather than rendering the full map.\</span>
</span><span id="Combiner.combine-381"><a href="#Combiner.combine-381"><span class="linenos">381</span></a><span class="sd">            Takes coordinates as they would appear in Minecraft. Using this will disable `autotrim` implicitly.</span>
</span><span id="Combiner.combine-382"><a href="#Combiner.combine-382"><span class="linenos">382</span></a><span class="sd">        :param force_size: Centers the final image in a new image of this size.\</span>
</span><span id="Combiner.combine-383"><a href="#Combiner.combine-383"><span class="linenos">383</span></a><span class="sd">            Using this will disable `autotrim` implicitly.</span>
</span><span id="Combiner.combine-384"><a href="#Combiner.combine-384"><span class="linenos">384</span></a>
</span><span id="Combiner.combine-385"><a href="#Combiner.combine-385"><span class="linenos">385</span></a><span class="sd">        :returns: Returns the created `MapImage` if successful, or `None` if the process failed or was cancelled at any point.</span>
</span><span id="Combiner.combine-386"><a href="#Combiner.combine-386"><span class="linenos">386</span></a><span class="sd">        :rtype: MapImage, None</span>
</span><span id="Combiner.combine-387"><a href="#Combiner.combine-387"><span class="linenos">387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Combiner.combine-388"><a href="#Combiner.combine-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="n">world</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mapped_worlds</span><span class="p">:</span>
</span><span id="Combiner.combine-389"><a href="#Combiner.combine-389"><span class="linenos">389</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No world directory of name &quot;</span><span class="si">{</span><span class="n">world</span><span class="si">}</span><span class="s1">&quot; exists in &quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-390"><a href="#Combiner.combine-390"><span class="linenos">390</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">detail</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
</span><span id="Combiner.combine-391"><a href="#Combiner.combine-391"><span class="linenos">391</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Detail level must be between 0 and 3; given </span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-392"><a href="#Combiner.combine-392"><span class="linenos">392</span></a>        <span class="n">source_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tiles_dir</span> <span class="o">/</span> <span class="n">world</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">detail</span><span class="p">)</span>
</span><span id="Combiner.combine-393"><a href="#Combiner.combine-393"><span class="linenos">393</span></a>
</span><span id="Combiner.combine-394"><a href="#Combiner.combine-394"><span class="linenos">394</span></a>        <span class="n">detail_mul</span> <span class="o">=</span> <span class="n">DETAIL_SBPP</span><span class="p">[</span><span class="n">detail</span><span class="p">]</span>
</span><span id="Combiner.combine-395"><a href="#Combiner.combine-395"><span class="linenos">395</span></a>
</span><span id="Combiner.combine-396"><a href="#Combiner.combine-396"><span class="linenos">396</span></a>        <span class="c1"># Sort out what regions we&#39;re going to stitch</span>
</span><span id="Combiner.combine-397"><a href="#Combiner.combine-397"><span class="linenos">397</span></a>        <span class="n">columns</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Combiner.combine-398"><a href="#Combiner.combine-398"><span class="linenos">398</span></a>        <span class="n">rows</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</span><span id="Combiner.combine-399"><a href="#Combiner.combine-399"><span class="linenos">399</span></a>        <span class="n">regions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Combiner.combine-400"><a href="#Combiner.combine-400"><span class="linenos">400</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Finding region images...&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-401"><a href="#Combiner.combine-401"><span class="linenos">401</span></a>        <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">source_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*_*.png&#39;</span><span class="p">),</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">):</span>
</span><span id="Combiner.combine-402"><a href="#Combiner.combine-402"><span class="linenos">402</span></a>            <span class="n">col</span><span class="p">,</span> <span class="n">row</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">stem</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
</span><span id="Combiner.combine-403"><a href="#Combiner.combine-403"><span class="linenos">403</span></a>            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">:</span>
</span><span id="Combiner.combine-404"><a href="#Combiner.combine-404"><span class="linenos">404</span></a>                <span class="n">columns</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</span><span id="Combiner.combine-405"><a href="#Combiner.combine-405"><span class="linenos">405</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="Combiner.combine-406"><a href="#Combiner.combine-406"><span class="linenos">406</span></a>            <span class="k">if</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
</span><span id="Combiner.combine-407"><a href="#Combiner.combine-407"><span class="linenos">407</span></a>                <span class="n">rows</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span id="Combiner.combine-408"><a href="#Combiner.combine-408"><span class="linenos">408</span></a>                <span class="n">regions</span><span class="p">[</span><span class="n">col</span><span class="p">][</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">img</span>
</span><span id="Combiner.combine-409"><a href="#Combiner.combine-409"><span class="linenos">409</span></a>
</span><span id="Combiner.combine-410"><a href="#Combiner.combine-410"><span class="linenos">410</span></a>        <span class="c1"># Deep-sort columns + rows</span>
</span><span id="Combiner.combine-411"><a href="#Combiner.combine-411"><span class="linenos">411</span></a>        <span class="n">regions</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:{</span><span class="n">v</span><span class="p">:</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">regions</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span>
</span><span id="Combiner.combine-412"><a href="#Combiner.combine-412"><span class="linenos">412</span></a>        <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner.combine-413"><a href="#Combiner.combine-413"><span class="linenos">413</span></a>        <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">rows</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner.combine-414"><a href="#Combiner.combine-414"><span class="linenos">414</span></a>
</span><span id="Combiner.combine-415"><a href="#Combiner.combine-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="Combiner.combine-416"><a href="#Combiner.combine-416"><span class="linenos">416</span></a>            <span class="n">area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="n">detail_mul</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">area</span><span class="p">])</span>
</span><span id="Combiner.combine-417"><a href="#Combiner.combine-417"><span class="linenos">417</span></a>            <span class="n">area_regions</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">n</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">snap_box</span><span class="p">(</span><span class="n">area</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)])</span>
</span><span id="Combiner.combine-418"><a href="#Combiner.combine-418"><span class="linenos">418</span></a>            <span class="n">column_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner.combine-419"><a href="#Combiner.combine-419"><span class="linenos">419</span></a>            <span class="n">row_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">area_regions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">area_regions</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Combiner.combine-420"><a href="#Combiner.combine-420"><span class="linenos">420</span></a>
</span><span id="Combiner.combine-421"><a href="#Combiner.combine-421"><span class="linenos">421</span></a>        <span class="n">size_estimate</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">)</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="Combiner.combine-422"><a href="#Combiner.combine-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm_yn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Estimated image size: </span><span class="si">{</span><span class="n">size_estimate</span><span class="si">}</span><span class="se">\n</span><span class="s1">Continue?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_confirmation</span><span class="p">):</span>
</span><span id="Combiner.combine-423"><a href="#Combiner.combine-423"><span class="linenos">423</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Cancelling...&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-424"><a href="#Combiner.combine-424"><span class="linenos">424</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Combiner.combine-425"><a href="#Combiner.combine-425"><span class="linenos">425</span></a>
</span><span id="Combiner.combine-426"><a href="#Combiner.combine-426"><span class="linenos">426</span></a>        <span class="c1"># Start stitching</span>
</span><span id="Combiner.combine-427"><a href="#Combiner.combine-427"><span class="linenos">427</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
</span><span id="Combiner.combine-428"><a href="#Combiner.combine-428"><span class="linenos">428</span></a>            <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span>
</span><span id="Combiner.combine-429"><a href="#Combiner.combine-429"><span class="linenos">429</span></a>            <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_range</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="Combiner.combine-430"><a href="#Combiner.combine-430"><span class="linenos">430</span></a>        <span class="p">)</span>
</span><span id="Combiner.combine-431"><a href="#Combiner.combine-431"><span class="linenos">431</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Constructing image...&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-432"><a href="#Combiner.combine-432"><span class="linenos">432</span></a>
</span><span id="Combiner.combine-433"><a href="#Combiner.combine-433"><span class="linenos">433</span></a>        <span class="n">ta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Combiner.combine-434"><a href="#Combiner.combine-434"><span class="linenos">434</span></a>        <span class="c1"># Represents where 0, 0 in our Minecraft world is, in relation to the image&#39;s coordinates</span>
</span><span id="Combiner.combine-435"><a href="#Combiner.combine-435"><span class="linenos">435</span></a>        <span class="n">game_zero_in_image</span><span class="p">:</span> <span class="n">Coord2i</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Combiner.combine-436"><a href="#Combiner.combine-436"><span class="linenos">436</span></a>        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">tqdm_product</span><span class="p">(</span><span class="n">column_range</span><span class="p">,</span> <span class="n">row_range</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Columns&#39;</span><span class="p">):</span>
</span><span id="Combiner.combine-437"><a href="#Combiner.combine-437"><span class="linenos">437</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">r</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">]):</span>
</span><span id="Combiner.combine-438"><a href="#Combiner.combine-438"><span class="linenos">438</span></a>                <span class="k">continue</span>
</span><span id="Combiner.combine-439"><a href="#Combiner.combine-439"><span class="linenos">439</span></a>            <span class="c1"># The pasting coordinates are determined based on what current column and row the for loops</span>
</span><span id="Combiner.combine-440"><a href="#Combiner.combine-440"><span class="linenos">440</span></a>            <span class="c1"># are on, so they&#39;ll increase by a tile regardless of whether an image has actually been pasted</span>
</span><span id="Combiner.combine-441"><a href="#Combiner.combine-441"><span class="linenos">441</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">column_range</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">row_range</span><span class="p">))</span>
</span><span id="Combiner.combine-442"><a href="#Combiner.combine-442"><span class="linenos">442</span></a>            <span class="n">tile_path</span> <span class="o">=</span> <span class="n">regions</span><span class="p">[</span><span class="n">c</span><span class="p">][</span><span class="n">r</span><span class="p">]</span>
</span><span id="Combiner.combine-443"><a href="#Combiner.combine-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tqdm</span><span class="p">:</span>
</span><span id="Combiner.combine-444"><a href="#Combiner.combine-444"><span class="linenos">444</span></a>                <span class="n">tqdm</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pasting image: </span><span class="si">{</span><span class="n">tile_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-445"><a href="#Combiner.combine-445"><span class="linenos">445</span></a>            <span class="n">paste_area</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">])</span>
</span><span id="Combiner.combine-446"><a href="#Combiner.combine-446"><span class="linenos">446</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">game_zero_in_image</span><span class="p">:</span>
</span><span id="Combiner.combine-447"><a href="#Combiner.combine-447"><span class="linenos">447</span></a>                <span class="n">game_zero_in_image</span> <span class="o">=</span> <span class="n">Coord2i</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">Coord2i</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">TILE_SIZE</span><span class="p">)</span>
</span><span id="Combiner.combine-448"><a href="#Combiner.combine-448"><span class="linenos">448</span></a>            <span class="n">image</span><span class="o">.</span><span class="n">paste</span><span class="p">((</span><span class="n">tile_img</span> <span class="o">:=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">tile_path</span><span class="p">)),</span> <span class="n">paste_area</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">tile_img</span><span class="p">)</span>
</span><span id="Combiner.combine-449"><a href="#Combiner.combine-449"><span class="linenos">449</span></a>
</span><span id="Combiner.combine-450"><a href="#Combiner.combine-450"><span class="linenos">450</span></a>        <span class="k">assert</span> <span class="n">game_zero_in_image</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">GAME_ZERO_IS_NONE</span>
</span><span id="Combiner.combine-451"><a href="#Combiner.combine-451"><span class="linenos">451</span></a>        <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">MapImageCoord</span><span class="p">(</span><span class="o">*</span><span class="n">game_zero_in_image</span><span class="p">),</span> <span class="n">detail_mul</span><span class="p">)</span>
</span><span id="Combiner.combine-452"><a href="#Combiner.combine-452"><span class="linenos">452</span></a>        <span class="k">del</span> <span class="n">game_zero_in_image</span>
</span><span id="Combiner.combine-453"><a href="#Combiner.combine-453"><span class="linenos">453</span></a>
</span><span id="Combiner.combine-454"><a href="#Combiner.combine-454"><span class="linenos">454</span></a>        <span class="c1"># Crop if an area is specified</span>
</span><span id="Combiner.combine-455"><a href="#Combiner.combine-455"><span class="linenos">455</span></a>        <span class="k">if</span> <span class="n">area</span><span class="p">:</span>
</span><span id="Combiner.combine-456"><a href="#Combiner.combine-456"><span class="linenos">456</span></a>            <span class="n">crop_area</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Combiner.combine-457"><a href="#Combiner.combine-457"><span class="linenos">457</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">(),</span>
</span><span id="Combiner.combine-458"><a href="#Combiner.combine-458"><span class="linenos">458</span></a>                <span class="o">*</span><span class="n">GameCoord</span><span class="p">(</span><span class="n">area</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">area</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">to_image_coord</span><span class="p">(</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()</span>
</span><span id="Combiner.combine-459"><a href="#Combiner.combine-459"><span class="linenos">459</span></a>            <span class="p">)</span>
</span><span id="Combiner.combine-460"><a href="#Combiner.combine-460"><span class="linenos">460</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">crop_area</span><span class="p">)</span>
</span><span id="Combiner.combine-461"><a href="#Combiner.combine-461"><span class="linenos">461</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Combiner.combine-462"><a href="#Combiner.combine-462"><span class="linenos">462</span></a>
</span><span id="Combiner.combine-463"><a href="#Combiner.combine-463"><span class="linenos">463</span></a>        <span class="c1"># Crop and resize if given an explicit size</span>
</span><span id="Combiner.combine-464"><a href="#Combiner.combine-464"><span class="linenos">464</span></a>        <span class="k">if</span> <span class="n">force_size</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">force_size</span><span class="p">):</span>
</span><span id="Combiner.combine-465"><a href="#Combiner.combine-465"><span class="linenos">465</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Resizing to </span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">force_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">...&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-466"><a href="#Combiner.combine-466"><span class="linenos">466</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize_canvas</span><span class="p">(</span><span class="o">*</span><span class="n">force_size</span><span class="p">)</span>
</span><span id="Combiner.combine-467"><a href="#Combiner.combine-467"><span class="linenos">467</span></a>            <span class="n">autotrim</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Combiner.combine-468"><a href="#Combiner.combine-468"><span class="linenos">468</span></a>
</span><span id="Combiner.combine-469"><a href="#Combiner.combine-469"><span class="linenos">469</span></a>        <span class="c1"># Things like grid lines and coordinate text are likely to end up drawn outside of the image&#39;s original bounding box,</span>
</span><span id="Combiner.combine-470"><a href="#Combiner.combine-470"><span class="linenos">470</span></a>        <span class="c1"># alterting what getbbox() would return. Get this bounding box *first*, and then use it to autotrim later.</span>
</span><span id="Combiner.combine-471"><a href="#Combiner.combine-471"><span class="linenos">471</span></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">getbbox</span><span class="p">()</span>
</span><span id="Combiner.combine-472"><a href="#Combiner.combine-472"><span class="linenos">472</span></a>        <span class="k">assert</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">AssertionMessage</span><span class="o">.</span><span class="n">BBOX_IS_NONE</span>
</span><span id="Combiner.combine-473"><a href="#Combiner.combine-473"><span class="linenos">473</span></a>
</span><span id="Combiner.combine-474"><a href="#Combiner.combine-474"><span class="linenos">474</span></a>        <span class="c1"># Add grid and/or coordinates</span>
</span><span id="Combiner.combine-475"><a href="#Combiner.combine-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="Combiner.combine-476"><a href="#Combiner.combine-476"><span class="linenos">476</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_interval</span><span class="p">:</span>
</span><span id="Combiner.combine-477"><a href="#Combiner.combine-477"><span class="linenos">477</span></a>                <span class="k">raise</span> <span class="n">CombineError</span><span class="p">(</span><span class="s1">&#39;A grid interval must be set for this Combiner instance to add grid lines or grid coordinates&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-478"><a href="#Combiner.combine-478"><span class="linenos">478</span></a>
</span><span id="Combiner.combine-479"><a href="#Combiner.combine-479"><span class="linenos">479</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_text</span><span class="p">:</span>
</span><span id="Combiner.combine-480"><a href="#Combiner.combine-480"><span class="linenos">480</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_coords_text</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner.combine-481"><a href="#Combiner.combine-481"><span class="linenos">481</span></a>
</span><span id="Combiner.combine-482"><a href="#Combiner.combine-482"><span class="linenos">482</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">show_grid_lines</span><span class="p">:</span>
</span><span id="Combiner.combine-483"><a href="#Combiner.combine-483"><span class="linenos">483</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Drawing grid lines...&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-484"><a href="#Combiner.combine-484"><span class="linenos">484</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">draw_grid_lines</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</span><span id="Combiner.combine-485"><a href="#Combiner.combine-485"><span class="linenos">485</span></a>
</span><span id="Combiner.combine-486"><a href="#Combiner.combine-486"><span class="linenos">486</span></a>        <span class="c1"># Trim transparent excess space</span>
</span><span id="Combiner.combine-487"><a href="#Combiner.combine-487"><span class="linenos">487</span></a>        <span class="k">if</span> <span class="n">autotrim</span><span class="p">:</span>
</span><span id="Combiner.combine-488"><a href="#Combiner.combine-488"><span class="linenos">488</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Trimming out blank space... (</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">bbox</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-489"><a href="#Combiner.combine-489"><span class="linenos">489</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
</span><span id="Combiner.combine-490"><a href="#Combiner.combine-490"><span class="linenos">490</span></a>
</span><span id="Combiner.combine-491"><a href="#Combiner.combine-491"><span class="linenos">491</span></a>        <span class="c1"># Apply desired background color, if any</span>
</span><span id="Combiner.combine-492"><a href="#Combiner.combine-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="Combiner.combine-493"><a href="#Combiner.combine-493"><span class="linenos">493</span></a>            <span class="n">image_bg</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGBA&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_color</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">())</span>
</span><span id="Combiner.combine-494"><a href="#Combiner.combine-494"><span class="linenos">494</span></a>            <span class="n">image_bg</span><span class="o">.</span><span class="n">alpha_composite</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">img</span><span class="p">)</span>
</span><span id="Combiner.combine-495"><a href="#Combiner.combine-495"><span class="linenos">495</span></a>            <span class="n">image</span> <span class="o">=</span> <span class="n">MapImage</span><span class="p">(</span><span class="n">image_bg</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">game_zero</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">detail_mul</span><span class="p">)</span>
</span><span id="Combiner.combine-496"><a href="#Combiner.combine-496"><span class="linenos">496</span></a>
</span><span id="Combiner.combine-497"><a href="#Combiner.combine-497"><span class="linenos">497</span></a>        <span class="c1"># Done.</span>
</span><span id="Combiner.combine-498"><a href="#Combiner.combine-498"><span class="linenos">498</span></a>        <span class="n">tb</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</span><span id="Combiner.combine-499"><a href="#Combiner.combine-499"><span class="linenos">499</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Image creation finished in </span><span class="si">{</span><span class="n">tb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ta</span><span class="si">:</span><span class="s1">04f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
</span><span id="Combiner.combine-500"><a href="#Combiner.combine-500"><span class="linenos">500</span></a>
</span><span id="Combiner.combine-501"><a href="#Combiner.combine-501"><span class="linenos">501</span></a>        <span class="k">return</span> <span class="n">image</span>
</span></pre></div>


            <div class="docstring"><p>Combine the given world (dimension) tile images into one large map.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>world</strong>:  Name of the world to combine images of.            Should be the name of a subdirectory located in this instance's <code><a href="#Combiner.tiles_dir">tiles_dir</a></code>.</li>
<li><strong>detail</strong>:  The level of detail, 0 up through 3, to use for this map.            Will correspond to which numbered subdirectory within the given world to use images from.</li>
<li><strong>area</strong>:  Specifies an area of the world to export rather than rendering the full map.            Takes coordinates as they would appear in Minecraft. Using this will disable <code>autotrim</code> implicitly.</li>
<li><strong>force_size</strong>:  Centers the final image in a new image of this size.            Using this will disable <code>autotrim</code> implicitly.</li>
</ul>

<p>:returns: Returns the created <code><a href="#MapImage">MapImage</a></code> if successful, or <code>None</code> if the process failed or was cancelled at any point.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>