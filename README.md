# py-squaremap-combiner <!-- omit in toc -->

[![Python
3.12](https://img.shields.io/badge/python-3.12-blue.svg)](https://www.python.org/downloads/release/python-3120/)

Python script written to combine the images generated by the
[squaremap](https://modrinth.com/plugin/squaremap) Minecraft plugin. Not
affiliated with squaremap or its authors.

The seed used for the world the sample images were created from is
`-2590089827693666277`.

## Contents <!-- omit in toc -->

- [Features](#features)
- [Installing](#installing)
- [Logging](#logging)
- [Basic CLI Usage](#basic-cli-usage)
- [CLI Options](#cli-options)
  - [Zoom/Detail Levels](#zoomdetail-levels)
  - [CLI Grid Options](#cli-grid-options)

## Features

- Stitch all squaremap-generated images for a given world into a single large map
- Export an image of only a specified area of the Minecraft world, by its in-game coordinates
- Grid overlay for maps, representing in-game coordinates
  - Grid lines and coordinate text can be toggled individually, and styled to a given color, font,
    and font size

## Installing

Install the package with pip:

```bash
pip install git+https://github.com/svioletg/py-squaremap-combiner.git`
```

Then, either use it as a command via `squaremap-combine`...

```bash
squaremap-combine run my-tiles overworld --zoom=2 -o worldmap_z2.png
```

...or import it and use as an API.

```python
from squaremap_combine.combine_core import Combiner

combiner = Combiner('my-tiles')
map_image = combiner.combine('minecraft_overworld', 2)
map_image.save('output.jpg')
```

## Logging

This project uses [loguru](https://github.com/Delgan/loguru) for its logging. Logging is disabled
by default for API usage, but enabled at the `INFO` level when run as a command.

Log files are saved to your user data directory (e.g. `C:\Users\<user>\AppData` or `~/.local/share`)
in its `logs` directory. Run `squaremap-combine logs` to print its path.

## Basic CLI Usage

The `squaremap-combine run` command will stitch together images from a given world/dimension
directory into a single map. This directory will be located in your server's `plugins` directory,
under `squaremap/web/tiles/<world>`. For example, if your current working directory is where your
server JAR is located, you may run this command:

```bash
squaremap-combine run plugins/squaremap/web/tiles/minecraft_overworld -o overworld.png
```

## CLI Options

> [!NOTE] "List" option types
> All "[xyz] list" options expect values to be given separated by comma as a single option, e.g. `--grid=32,32` or `--area=-100,-100,100,100`.

|Option|Type|Default|Description|
|------|----|-------|-----------|
|`-h/--help`|Flag|N/A|Displays information about every argument / option and their parameters.|
|`-z/--zoom`|Integer|3|The zoom/detail level of tiles to use. Defaults to the highest level of 3, which is 1 block per pixel.|
|`-o/--out FILEPATH`|File path|`<world_name>.png`|Where to save the combined map image. Defaults to the current directory and named after the world folder name.|
|`--overwite`|Flag|`False`|Allows the script to overwrite an existing file with the same target name if it already exists. By default, if an image with the same path already exists, a numbered suffix is added.|
|`-r/--rect X1,Z1,X2,Z2`|Integer list (4)|Entire rendered map area|A rectangle area of the world to export an image of, separated by commas.|
|`-t/--trim`|Flag|`False`|Trims empty (fully transparent) space surrounding the completed image. Note that this is done before any specified background color is applied.|
|`-y/--yes-to-all`|Flag|`False`|Automatically accepts and bypasses all confirmation prompts|
|`-g/--grid`|Integer list (2)|`512,512`|Defines the grid interval. Does nothing on its own, but is required to use any `--grid-*` options.|

### Zoom/Detail Levels

| Detail | Description |
|---|---|
| 3 | 1 block per pixel |
| 2 | 2x2 block area per pixel |
| 1 | 4x4 block area per pixel |
| 0 | 8x8 block area per pixel |

### CLI Grid Options

> [!NOTE]
> All options below prefixed with `grid-` are only used if `--grid` is specified; otherwise, they do nothing.

|Option|Type|Default|Description|
|------|----|-------|-----------|
|`--grid-lines`|String|`"black 1px"`|The color and pixel size to use for grid lines, separated by space. The color given can be either a hex code (must be preceded by `#`) or [one of 16 color names](https://www.w3.org/TR/REC-html40/types.html#h-6.5) defined in the HTML 4.01 spec.  |
|`--grid-coords`|String|`"{x}, {z}"`|The string format to use for overlaying grid coordinates, replacing `{x}` and `{z}` with the respective coordinate values, e.g. `"X: {x}, Z: {z}"`. By default, coordinates are not added to the image at all.|
